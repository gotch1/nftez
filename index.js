var LT;(()=>{"use strict";function e(e){return Array.from((new TextEncoder).encode(e),(e=>e.toString(16).padStart(2,"0"))).join("")}function t(e){const t=new Uint8Array(e.length/2);for(let n=0;n!==t.length;n++)t[n]=parseInt(e.substr(2*n,2),16);return(new TextDecoder).decode(t)}function n(e){return e&&e.length>14?e.substring(0,5)+"..."+e.substring(e.length-5):e}function o(e){if(navigator.clipboard)return navigator.clipboard.writeText(e).then((function(){}),(function(e){return console.log("ERROR copyToClipboard(): "+e),!1})),!0;let t;var n=document.createElement("textarea");n.value=e,n.style.top="0",n.style.left="0",n.style.position="fixed",document.body.appendChild(n),n.focus(),n.select();try{document.execCommand("copy"),t=!0}catch(e){console.log("ERROR copyToClipboard(): "+e)}return document.body.removeChild(n),t}const a=new beacon.DAppClient({name:"NFTez"});let s="ghostnet",i="";async function c(e){try{let t=await fetch("https://api."+s+".tzkt.io/v1/contracts/"+e+"/bigmaps/metadata/keys?key=content&select=value");if(t.ok)return(await t.json())[0];console.log("ERROR getCollection(): can't get collection")}catch(e){console.log("ERRROR getCollection(): "+JSON.stringify(e))}}const r={message:"The address is copied",type:"is-success"};async function l(){d(),document.getElementById("dLastTokens").innerHTML="",document.getElementById("contentLastTokens").classList.remove("is-hidden");let e=document.getElementById("dLastTokens"),t=0,n=await async function(){try{let e=await fetch("https://api."+s+".tzkt.io/v1/tokens?sort.desc=lastActivity&select=contract,tokenId,totalSupply,metadata&metadata.artifactUri.as=data*&limit=50");if(e.ok)return await e.json();console.log("ERROR getLastTokens(): can't get tokens")}catch(e){console.log("ERRROR getLastTokens(): "+JSON.stringify(e))}}();for(let o of n){t++;let n=k(o);e.append(n)}0===(h+=t)&&(e.textContent="There are no tokens yet.")}function d(){document.querySelectorAll(".js-page").forEach((function(e){e.classList.add("is-hidden")}))}bulmaToast.setDefaults({duration:5e3,position:"bottom-left",dismissible:!0,animate:{in:"zoomIn",out:"zoomOut"}}),document.addEventListener("DOMContentLoaded",(async function(){document.getElementById("titleNetwork").innerHTML="&nbsp;"+s,await B(!0);let e=new URLSearchParams(window.location.search).get("cmd");"info"===e?await(document.getElementById("btnBurger").classList.remove("is-active"),document.getElementById("navbarMenu").classList.remove("is-active"),d(),void document.getElementById("pageInfo").classList.remove("is-hidden")):"tokens"===e?await async function(){d(),document.getElementById("dTokens").innerHTML="",document.getElementById("pageTokens").classList.remove("is-hidden");let e=new URLSearchParams(window.location.search).get("cid");if(e){p=e;let t=document.getElementById("bthNewToken"),n=await async function(e){let t="select=address,tokensCount,firstActivityTime,creator.address as creator&address="+e;try{let e=await fetch("https://api."+s+".tzkt.io/v1/contracts?"+t);if(e.ok)return await e.json();console.log("ERROR getCollection(): can't get collection")}catch(e){console.log("ERRROR getCollection(): "+JSON.stringify(e))}}(e);n&&n.length>0&&n[0].creator===i?t.classList.remove("is-hidden"):t.classList.add("is-hidden")}await E()}():"token"===e?await async function(){d();let e=document.getElementById("btnTokenBurn");e.classList.add("is-hidden");let t=document.getElementById("btnTokenTransfer");t.classList.add("is-hidden"),document.getElementById("dToken").classList.add("is-hidden"),document.getElementById("pageToken").classList.remove("is-hidden");let n=new URLSearchParams(window.location.search),o=n.get("cid");o?p=o:o=p;let a=n.get("tid");a?T=a:a=T;let c,r=document.getElementById("pageToken"),l=await async function(e,t){let n="limit=1&select=account.address as account,token,balance,firstTime&token.contract="+e+"&token.tokenid="+t;try{let e=await fetch("https://api."+s+".tzkt.io/v1/tokens/balances?"+n+"&account="+i);if(e.ok){let t=await e.json();if(t.length>0)return t[0];{let e=await fetch("https://api."+s+".tzkt.io/v1/tokens/balances?"+n);if(e.ok){if(t=await e.json(),t.length>0)return t[0].account=i,t[0].balance=0,t[0]}else console.log("ERROR getToken(): can't get token")}}else console.log("ERROR getToken(): can't get token balance")}catch(e){console.log("ERRROR getToken(): "+JSON.stringify(e))}}(p,a);if(l){let n;v=l,l.account===i&&l.balance>0&&(e.classList.remove("is-hidden"),t.classList.remove("is-hidden")),r.querySelector(".js-name").innerText=l.token.metadata?.name,c=l.token.metadata?.description,r.querySelector(".js-description").innerText=c||"",c=l.token.totalSupply,r.querySelector(".js-editions").innerText=c||"",c=l.firstTime,r.querySelector(".js-firsttime").innerText=c?new Date(Date.parse(c)).toLocaleString():"",c=l.token.contract.address;let o=new URL(window.location);n=r.querySelector(".js-contract"),n.setAttribute("href",o.origin+o.pathname+"?cmd=tokens&cid="+c),n.innerText=c||"",c=l.token.tokenId,r.querySelector(".js-tokenid").innerText=c||"",c=l.token.metadata?.tags;try{c=JSON.parse(c).join(", ")}catch(e){c=""}r.querySelector(".js-tags").innerText=c||"";let a=l.token.metadata?.mimeType;if(r.querySelector(".js-type").innerText=a||"",c=l.token.metadata?.artifactUri,c){try{new URL(c),c=c.replace("ipfs://","https://ipfs.io/ipfs/")}catch(e){}a&&a.startsWith("video")?(n=r.querySelector(".js-img"),n.parentNode.removeChild(n),n=r.querySelector(".js-audio"),n.parentNode.removeChild(n),n=r.querySelector(".js-video")):a&&a.startsWith("audio")?(n=r.querySelector(".js-img"),n.parentNode.removeChild(n),n=r.querySelector(".js-video"),n.parentNode.removeChild(n),n=r.querySelector(".js-audio")):(n=r.querySelector(".js-video"),n.parentNode.removeChild(n),n=r.querySelector(".js-audio"),n.parentNode.removeChild(n),n=r.querySelector(".js-img")),n.setAttribute("src",c),n.classList.remove("is-hidden")}document.getElementById("dToken").classList.remove("is-hidden")}}():"search"===e?await async function(){d(),document.getElementById("pageSearch").classList.remove("is-hidden")}():"collections"===e?await y():await l()})),document.getElementById("btnMenuExplore").addEventListener("click",(()=>async function(){window.location.search="cmd=collections"}())),document.getElementById("btnMenuSearch").addEventListener("click",(()=>async function(){window.location.search="cmd=search"}())),document.getElementById("btnMenuInfo").addEventListener("click",(()=>async function(){window.location.search="cmd=info"}())),document.getElementById("btnNetMainnet").addEventListener("click",(()=>I("mainnet"))),document.getElementById("btnNetGhostnet").addEventListener("click",(()=>I("ghostnet"))),document.getElementById("btnCopyAddress").addEventListener("click",(()=>function(){let e;i&&(e=o(i)),e&&bulmaToast.toast(r)}())),document.getElementById("btnMyCollections").addEventListener("click",(()=>async function(){window.location.search="cmd=collections&creator="+i}())),document.getElementById("btnConnect").addEventListener("click",(()=>B(!1))),document.getElementById("btnDisconnect").addEventListener("click",(()=>async function(){await async function(){await a.removeAllAccounts(),i=""}(),i||(document.getElementById("divDisconnect").classList.add("is-hidden"),document.getElementById("aAddress").innerHTML="",document.getElementById("divConnect").classList.remove("is-hidden"),d(),document.querySelectorAll(".js-loggedin").forEach((function(e){e.classList.add("is-hidden")}))),await l()}())),document.getElementById("isMineCollections").addEventListener("change",(()=>function(){let e=new URL(window.location);document.getElementById("isMineCollections").checked?e.searchParams.set("creator",i):e.searchParams.get("creator")===i&&e.searchParams.delete("creator"),window.location.href=e}())),document.getElementById("btnNewCollection").addEventListener("click",(()=>async function(){d(),document.getElementById("cCreators").value=i,document.getElementById("contentNewCollection").classList.remove("is-hidden")}())),document.getElementById("btnNewCollectionCreate").addEventListener("click",(()=>async function(){let t,n=new Map;t=document.getElementById("cName").value.trim(),t&&n.set("name",t),t=document.getElementById("cDescription").value.trim(),t&&n.set("description",t),t=document.getElementById("cSymbol").value.trim(),t&&n.set("symbol",t),t=document.getElementById("cType").value.trim(),t&&n.set("type",t),t=document.getElementById("cInterfaces").value.split(/\s*,\s*/).filter((e=>e.length>0)),t.length>0&&n.set("interfaces",t),t=document.getElementById("cAuthors").value.split(/\s*,\s*/).filter((e=>e.length>0)),t.length>0&&n.set("authors",t),t=document.getElementById("cAddresses").value.split(/\s*,\s*/).filter((e=>e.length>0)),t.length>0&&n.set("authoraddress",t),t=document.getElementById("cCreators").value.split(/\s*,\s*/).filter((e=>e.length>0)),t.length>0&&n.set("creators",t);const o=document.getElementById("cFile").files;o.length>0&&(t=await new Promise((e=>{let t=new FileReader;t.onload=n=>e(t.result),t.readAsDataURL(o[0])})),n.set("imageUri",t));let s=await async function(t){let n=t.size>0?e(JSON.stringify(Object.fromEntries(t))):"";try{let e=await fetch("./collection02.json");if(e.ok){let t=await e.text();t&&(t=t.replaceAll("${user_address}",i),t=t.replaceAll("${metadata_content}",n));const o=await a.requestOperation({operationDetails:[{kind:beacon.TezosOperationType.ORIGINATION,balance:"0",script:JSON.parse(t)}]});if(o.transactionHash)return o.transactionHash}else console.log("ERROR createCollection(): can't create collection")}catch(e){console.log("ERRROR createCollection(): "+JSON.stringify(e))}}(n);s&&L(s)}())),document.getElementById("btnNewCollectionCancel").addEventListener("click",(()=>async function(){d(),document.getElementById("pageCollections").classList.remove("is-hidden")}())),document.getElementById("btnMoreCollections").addEventListener("click",(()=>g())),document.getElementById("btnSearch").addEventListener("click",(()=>async function(){if(document.getElementById("searchColTab").classList.contains("is-active"))window.location.search="cmd=collections&creator="+document.getElementById("searchColCreator").value.trim();else if(document.getElementById("searchTokTab").classList.contains("is-active")){let e="",t=document.getElementById("searchTokName").value.trim();t&&(e+="&name="+t),t=document.getElementById("searchTokCreators").value.trim().split(/\s*,\s*/).filter((e=>e.length>2));for(let n of t)e+="&creator="+n.trim();t=document.getElementById("searchTokTags").value.trim().split(/\s*,\s*/).filter((e=>e.length>0));for(let n of t)e+="&tag="+n.trim();t=document.getElementById("searchTokType").value.trim(),t&&(e+="&type="+t),t=document.getElementById("searchTokMinter").value.trim(),t&&(e+="&minter="+t),window.location.search="cmd=tokens"+e}}())),document.getElementById("btnTokensCancel").addEventListener("click",(()=>async function(){window.history.back()}())),document.getElementById("bthNewToken").addEventListener("click",(()=>async function(){d(),document.getElementById("nftCreators").value=i,document.getElementById("contentNewToken").classList.remove("is-hidden")}())),document.getElementById("btnNewTokenCreate").addEventListener("click",(()=>async function(){let t,n=new Map;t=document.getElementById("nftName").value.trim(),t&&n.set("name",t),t=document.getElementById("nftDescription").value.trim(),t&&n.set("description",t),t=document.getElementById("nftTags").value.trim().split(/\s*,\s*/).filter((e=>e.length>2)),t.length>0&&(t.sort(((e,t)=>e.localeCompare(t))),n.set("tags",t)),t=document.getElementById("nftCreators").value.trim().split(/\s*,\s*/).filter((e=>e.length>0)),t.length>0&&(t.sort(),n.set("creators",t)),t=document.getElementById("nftType").value.trim(),t&&n.set("mimeType",t),t=document.getElementById("nftDecimals").value.trim(),t&&n.set("decimals",t),t=document.getElementById("nftRoyalties").value.trim(),t&&n.set("royalties",t),t=document.getElementById("nftRights").value.trim(),t&&n.set("rights",t);const o=document.getElementById("nftFile").files;o.length>0&&(t=await new Promise((e=>{let t=new FileReader;t.onload=n=>e(t.result),t.readAsDataURL(o[0])})),n.set("artifactUri",t));let c=document.getElementById("nftEditions").value,r=await async function(t,n,o){let c="";if((o=new Map([...o].sort())).size>0){let t=0;for(let[n,a]of o)t>0&&(c+=","),t++,c+='{"prim":"Elt","args":[{"string":"'+n+'"},{"bytes":"'+e("string"==typeof a||a instanceof String?a:JSON.stringify(a))+'"}]}'}try{let e='{"prim":"Pair","args":[{"int":"'+n+'"},{"prim":"Pair","args":[['+c+'],{"string":"'+i+'"}]}]}';try{let n=await fetch("https://api."+s+".tzkt.io/v1/contracts/"+t+"/entrypoints/mint"),o=await n.json();2===Object.keys(o.jsonParameters["schema:object"]).length&&(e='{"prim":"Pair","args":[['+c+'],{"string":"'+i+'"}]}')}catch(e){}let o=await a.requestOperation({operationDetails:[{kind:beacon.TezosOperationType.TRANSACTION,amount:0,destination:t,parameters:{entrypoint:"mint",value:JSON.parse(e)}}]});if(o.transactionHash)return o.transactionHash}catch(e){console.log("ERRROR createToken(): "+e+" "+JSON.stringify(e))}}(p,c,n);r&&L(r)}())),document.getElementById("btnNewTokenCancel").addEventListener("click",(()=>async function(){d(),document.getElementById("pageTokens").classList.remove("is-hidden")}())),document.getElementById("btnMoreTokens").addEventListener("click",(()=>E())),document.getElementById("btnTokenCancel").addEventListener("click",(()=>async function(){window.history.back()}())),document.getElementById("btnTokenBurn").addEventListener("click",(()=>async function(){v&&document.getElementById("mBurnTokenAmount").setAttribute("max",v.balance),document.getElementById("mBurnToken").classList.add("is-active")}())),document.getElementById("btnBurnTokenBurn").addEventListener("click",(()=>async function(){let e=document.getElementById("mBurnTokenAmount").value,t=await async function(e,t,n){try{let o='{"prim":"Pair","args":[{"int":"'+n+'"},{"int":"'+t+'"}]}';try{let n=await fetch("https://api."+s+".tzkt.io/v1/contracts/"+e+"/entrypoints/burn?json=false&michelson=true");(await n.json()).michelsonParameters.startsWith("pair")||(o='{"int":"'+t+'"}')}catch(e){}let i=await a.requestOperation({operationDetails:[{kind:beacon.TezosOperationType.TRANSACTION,amount:0,destination:e,parameters:{entrypoint:"burn",value:JSON.parse(o)}}]});if(i.transactionHash)return i.transactionHash}catch(e){console.log("ERRROR burnToken(): "+e+" "+JSON.stringify(e))}}(p,T,e);t&&(L(t),window.history.back())}())),document.getElementById("btnTokenTransfer").addEventListener("click",(()=>async function(){v&&document.getElementById("mTransferTokenAmount").setAttribute("max",v.balance),document.getElementById("mTransferTokenAddressTo").value="",document.getElementById("mTransferToken").classList.add("is-active")}())),document.getElementById("btnTransferTokenTransfer").addEventListener("click",(()=>async function(){let e=document.getElementById("mTransferTokenAmount").value,t=document.getElementById("mTransferTokenAddressTo").value.trim();if(e&&t){let n=await async function(e,t,n,o){try{let s=await a.requestOperation({operationDetails:[{kind:beacon.TezosOperationType.TRANSACTION,amount:0,destination:e,parameters:{entrypoint:"transfer",value:JSON.parse('[{"prim": "Pair","args":[{"string":"'+i+'"},[{"prim": "Pair","args":[{"string":"'+o+'"},{"prim": "Pair","args":[{"int":"'+t+'"},{"int":"'+n+'"}]}]}]]}]')}}]});if(s.transactionHash)return s.transactionHash}catch(e){console.log("ERRROR transferToken(): "+e+" "+JSON.stringify(e))}}(p,T,e,t);n&&L(n),document.getElementById("mTransferToken").classList.remove("is-active")}else bulmaToast.toast({message:"The address must not be empty",type:"is-danger"})}())),document.querySelectorAll(".js-faq-item").forEach((function(e){e.onclick=w}));const m=15;var u=0;async function y(){d(),document.getElementById("dCollections").innerHTML="",document.getElementById("pageCollections").classList.remove("is-hidden"),await g()}async function g(){let e=document.getElementById("btnMoreCollections");e.classList.add("is-loading");let n=document.getElementById("dCollections"),o=0,a=new URLSearchParams(window.location.search).get("creator");document.getElementById("isMineCollections").checked=a===i;let r=await async function(e,t,n){let o="sort.desc=lastActivity&select=address,tokensCount,firstActivityTime,creator.address as creator&typeHash=-1889653220"+(t?"&limit="+t:"")+(n?"&offset="+n:"")+(e?"&creator="+e:"");try{let e=await fetch("https://api."+s+".tzkt.io/v1/contracts?"+o);if(e.ok)return await e.json();console.log("ERROR getCollections(): can't get collections")}catch(e){console.log("ERRROR getCollections(): "+JSON.stringify(e))}}(a,m,u);if(r)for(let e of r){o++;let a=await c(e.address);if(a)try{a=JSON.parse(t(a))}catch(e){continue}const s=document.getElementById("t-collection").content.cloneNode(!0);let i=a?.imageUri;if(i){try{new URL(i),i=i.replace("ipfs://","https://ipfs.io/ipfs/")}catch(e){}s.querySelector(".js-img").setAttribute("src",i)}s.querySelector(".js-name").innerText=a?.name,s.querySelector(".js-description").innerText=a?.description,s.querySelector(".js-address").textContent=e.address,s.querySelector(".js-count").innerText=e.tokensCount;let r=new URL(window.location);s.querySelectorAll(".js-collection-item").forEach((function(t){t.setAttribute("href",r.origin+r.pathname+"?cmd=tokens&cid="+e.address)})),n.append(s)}let l=document.getElementById("dMoreCollections");o<m?l.classList.add("is-hidden"):l.classList.remove("is-hidden"),e.classList.remove("is-loading"),0===(u+=o)&&(n.textContent="There are no collections yet.")}const f=10;var h=0,p="";async function E(){let e=document.getElementById("btnMoreTokens");e.classList.add("is-loading");let t=document.getElementById("dTokens"),n=0,o=new URLSearchParams(window.location.search),a=await async function(e,t,n,o,a,i,c,r){let l="sort.desc=id&select=contract,tokenId,totalSupply,metadata"+(e?"&limit="+e:"")+(t?"&offset="+t:"")+(n?"&contract.in="+n:"")+(r?"&firstMinter="+r:"")+(o?"&metadata.name="+o:"")+"&metadata.artifactUri.as=data:"+(c||"")+"*";if(a&&a.length>0){a.sort(),l+="&metadata.creators.as=*";for(let e of a)l+='"'+e+'"*'}if(i&&i.length>0){i.sort(((e,t)=>e.localeCompare(t))),l+="&metadata.tags.as=*";for(let e of i)l+='"'+e+'"*'}try{let e=await fetch("https://api."+s+".tzkt.io/v1/tokens?"+l);if(e.ok)return await e.json();console.log("ERROR getTokens(): can't get tokens")}catch(e){console.log("ERRROR getTokens(): "+JSON.stringify(e))}}(f,h,o.get("cid"),o.get("name"),o.getAll("creator"),o.getAll("tag"),o.get("type"),o.get("minter"));for(let e of a){n++;let o=k(e);t.append(o)}let i=document.getElementById("dMoreTokens");n<f?i.classList.add("is-hidden"):i.classList.remove("is-hidden"),e.classList.remove("is-loading"),0===(h+=n)&&(t.textContent="There are no tokens yet.")}function k(e){const t=document.getElementById("t-token").content.cloneNode(!0);let n,o=e.metadata?.name;if(n=t.querySelector(".js-name"),n.innerText=o||"",o=e.metadata?.description,n=t.querySelector(".js-description"),n.innerText=o||"",o=e.totalSupply,n=t.querySelector(".js-count"),n.innerText=o||"",o=e.metadata?.artifactUri,o){try{new URL(o),o=o.replace("ipfs://","https://ipfs.io/ipfs/")}catch(e){}let a=e.metadata?.mimeType;a&&a.startsWith("video")?(n=t.querySelector(".js-img"),n.parentNode.removeChild(n),n=t.querySelector(".js-audio"),n.parentNode.removeChild(n),n=t.querySelector(".js-video")):a&&a.startsWith("audio")?(n=t.querySelector(".js-img"),n.parentNode.removeChild(n),n=t.querySelector(".js-video"),n.parentNode.removeChild(n),n=t.querySelector(".js-audio")):(n=t.querySelector(".js-video"),n.parentNode.removeChild(n),n=t.querySelector(".js-audio"),n.parentNode.removeChild(n),n=t.querySelector(".js-img")),n.setAttribute("src",o),n.classList.remove("is-hidden")}let a=new URL(window.location);return t.querySelectorAll(".js-token-item").forEach((function(t){t.setAttribute("href",a.origin+a.pathname+"?cmd=token&cid="+e.contract.address+"&tid="+e.tokenId)})),t}var v,T="";function w(){let e=event.currentTarget.querySelector(".fas");event.currentTarget.parentElement.querySelector(".is-collapsible").classList.toggle("is-active"),e.classList.toggle("fa-angle-down"),e.classList.toggle("fa-angle-up")}async function I(e){var t;document.querySelectorAll(".has-dropdown").forEach((function(e){e.classList.remove("is-hoverable"),setTimeout((function(){e.classList.add("is-hoverable")}),100)})),e!==s&&(s!==(t=e)&&(s=t,a.network={type:s},console.log("dAppClient.network="+a.network.type)),document.getElementById("titleNetwork").innerHTML="&nbsp;"+s,await y())}async function B(e){await async function(e){let t=await a.getActiveAccount();if(t)i=t.address;else if(!e){let e=await a.requestPermissions({network:{type:s}});i=e.address}}(e),i?(document.getElementById("divConnect").classList.add("is-hidden"),document.getElementById("aAddress").innerHTML=n(i),document.getElementById("divDisconnect").classList.remove("is-hidden"),document.querySelectorAll(".js-loggedin").forEach((function(e){}))):document.querySelectorAll(".js-loggedin").forEach((function(e){e.classList.add("is-hidden")}))}function L(e){bulmaToast.toast({message:"Your request is processing with ID <a href='https://"+s+".tzkt.io/"+e+"' target='_blank'>"+n(e)+"</a>",duration:5e3,type:"is-success"})}LT={}})();