var LT;(()=>{"use strict";function e(e){return Array.from((new TextEncoder).encode(e),(e=>e.toString(16).padStart(2,"0"))).join("")}function t(e){const t=new Uint8Array(e.length/2);for(let r=0;r!==t.length;r++)t[r]=parseInt(e.substr(2*r,2),16);return(new TextDecoder).decode(t)}function r(e){return e&&e.length>14?e.substring(0,5)+"..."+e.substring(e.length-5):e}function i(e){if(navigator.clipboard)return navigator.clipboard.writeText(e).then((function(){}),(function(e){return!1})),!0;let t=!1;var r=document.createElement("textarea");r.value=e,r.style.top="0",r.style.left="0",r.style.position="fixed",document.body.appendChild(r),r.focus(),r.select();try{document.execCommand("copy"),t=!0}catch(e){}return document.body.removeChild(r),t}function a(e){return/^(tz|KT)[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{34}$/.test(String(e))}function s(e,t){let r=e.substring(0,2);return r!==t.substring(0,2)?"tz"===r?-1:1:e>t?1:e<t?-1:0}function n(){try{return(new Error).stack.split("\n")[2].replace(/^\s+at\s+(.+?)\s.+/g,"$1")}catch(e){return""}}const o=window.location,m=!o.protocol.startsWith("http"),d=m||(o.host+o.pathname).indexOf("testnet")<0&&(o.host+o.pathname).indexOf("ghostnet")<0,l=d?"mainnet":"ghostnet",c=d?"KT1Q4Dc6UkQP4ncBPkJYkHRFc1heopuD1tqX":"KT1UhuDXQ8jAWkaR1BLNaARbrhXwdr7LotPZ",p=d?"KT1KyPvhak54X3yiozebqhPhnqrtWNTiaWm1":"KT1TRuN4Uc4ai6ZjWRjtedX9ChmfcfvxfBXt",g=[-1665803695],u=g.join()+","+[-1835576114].join()+","+[862045731,-1513923773,-1889653220,-543526052,943737041].join();function y(e){return-1275828732===e||g.includes(e)}const E='{"code":[{"prim":"storage","args":[{"prim":"pair","args":[{"prim":"pair","args":[{"prim":"pair","args":[{"prim":"address","annots":["%administrator"]},{"prim":"nat","annots":["%all_tokens"]}]},{"prim":"pair","args":[{"prim":"set","args":[{"prim":"address"}],"annots":["%collaborators"]},{"prim":"big_map","args":[{"prim":"pair","args":[{"prim":"address"},{"prim":"nat"}]},{"prim":"nat"}],"annots":["%ledger"]}]}]},{"prim":"pair","args":[{"prim":"pair","args":[{"prim":"big_map","args":[{"prim":"string"},{"prim":"bytes"}],"annots":["%metadata"]},{"prim":"big_map","args":[{"prim":"nat"},{"prim":"address"}],"annots":["%minters"]}]},{"prim":"pair","args":[{"prim":"big_map","args":[{"prim":"pair","args":[{"prim":"address","annots":["%owner"]},{"prim":"pair","args":[{"prim":"address","annots":["%operator"]},{"prim":"nat","annots":["%token_id"]}]}]},{"prim":"unit"}],"annots":["%operators"]},{"prim":"pair","args":[{"prim":"big_map","args":[{"prim":"nat"},{"prim":"pair","args":[{"prim":"nat","annots":["%token_id"]},{"prim":"map","args":[{"prim":"string"},{"prim":"bytes"}],"annots":["%token_info"]}]}],"annots":["%token_metadata"]},{"prim":"big_map","args":[{"prim":"nat"},{"prim":"nat"}],"annots":["%total_supply"]}]}]}]}]}]},{"prim":"parameter","args":[{"prim":"or","args":[{"prim":"or","args":[{"prim":"or","args":[{"prim":"set","args":[{"prim":"address"}],"annots":["%add_collaborators"]},{"prim":"pair","args":[{"prim":"string","annots":["%k"]},{"prim":"pair","args":[{"prim":"nat","annots":["%token_id"]},{"prim":"bytes","annots":["%v"]}]}],"annots":["%append_token_metadata"]}]},{"prim":"or","args":[{"prim":"pair","args":[{"prim":"list","args":[{"prim":"pair","args":[{"prim":"address","annots":["%owner"]},{"prim":"nat","annots":["%token_id"]}]}],"annots":["%requests"]},{"prim":"contract","args":[{"prim":"list","args":[{"prim":"pair","args":[{"prim":"pair","args":[{"prim":"address","annots":["%owner"]},{"prim":"nat","annots":["%token_id"]}],"annots":["%request"]},{"prim":"nat","annots":["%balance"]}]}]}],"annots":["%callback"]}],"annots":["%balance_of"]},{"prim":"or","args":[{"prim":"pair","args":[{"prim":"nat","annots":["%amount"]},{"prim":"nat","annots":["%token_id"]}],"annots":["%burn"]},{"prim":"pair","args":[{"prim":"address","annots":["%address"]},{"prim":"pair","args":[{"prim":"nat","annots":["%amount"]},{"prim":"map","args":[{"prim":"string"},{"prim":"bytes"}],"annots":["%metadata"]}]}],"annots":["%mint"]}]}]}]},{"prim":"or","args":[{"prim":"or","args":[{"prim":"set","args":[{"prim":"address"}],"annots":["%remove_collaborators"]},{"prim":"list","args":[{"prim":"pair","args":[{"prim":"address","annots":["%from_"]},{"prim":"list","args":[{"prim":"pair","args":[{"prim":"address","annots":["%to_"]},{"prim":"pair","args":[{"prim":"nat","annots":["%token_id"]},{"prim":"nat","annots":["%amount"]}]}]}],"annots":["%txs"]}]}],"annots":["%transfer"]}]},{"prim":"or","args":[{"prim":"bytes","annots":["%update_contract_metadata"]},{"prim":"or","args":[{"prim":"list","args":[{"prim":"or","args":[{"prim":"pair","args":[{"prim":"address","annots":["%owner"]},{"prim":"pair","args":[{"prim":"address","annots":["%operator"]},{"prim":"nat","annots":["%token_id"]}]}],"annots":["%add_operator"]},{"prim":"pair","args":[{"prim":"address","annots":["%owner"]},{"prim":"pair","args":[{"prim":"address","annots":["%operator"]},{"prim":"nat","annots":["%token_id"]}]}],"annots":["%remove_operator"]}]}],"annots":["%update_operators"]},{"prim":"pair","args":[{"prim":"map","args":[{"prim":"string"},{"prim":"bytes"}],"annots":["%metadata"]},{"prim":"nat","annots":["%token_id"]}],"annots":["%update_token_metadata"]}]}]}]}]}]},{"prim":"code","args":[[{"prim":"CAST","args":[{"prim":"pair","args":[{"prim":"or","args":[{"prim":"or","args":[{"prim":"or","args":[{"prim":"set","args":[{"prim":"address"}]},{"prim":"pair","args":[{"prim":"string"},{"prim":"pair","args":[{"prim":"nat"},{"prim":"bytes"}]}]}]},{"prim":"or","args":[{"prim":"pair","args":[{"prim":"list","args":[{"prim":"pair","args":[{"prim":"address"},{"prim":"nat"}]}]},{"prim":"contract","args":[{"prim":"list","args":[{"prim":"pair","args":[{"prim":"pair","args":[{"prim":"address"},{"prim":"nat"}]},{"prim":"nat"}]}]}]}]},{"prim":"or","args":[{"prim":"pair","args":[{"prim":"nat"},{"prim":"nat"}]},{"prim":"pair","args":[{"prim":"address"},{"prim":"pair","args":[{"prim":"nat"},{"prim":"map","args":[{"prim":"string"},{"prim":"bytes"}]}]}]}]}]}]},{"prim":"or","args":[{"prim":"or","args":[{"prim":"set","args":[{"prim":"address"}]},{"prim":"list","args":[{"prim":"pair","args":[{"prim":"address"},{"prim":"list","args":[{"prim":"pair","args":[{"prim":"address"},{"prim":"pair","args":[{"prim":"nat"},{"prim":"nat"}]}]}]}]}]}]},{"prim":"or","args":[{"prim":"bytes"},{"prim":"or","args":[{"prim":"list","args":[{"prim":"or","args":[{"prim":"pair","args":[{"prim":"address"},{"prim":"pair","args":[{"prim":"address"},{"prim":"nat"}]}]},{"prim":"pair","args":[{"prim":"address"},{"prim":"pair","args":[{"prim":"address"},{"prim":"nat"}]}]}]}]},{"prim":"pair","args":[{"prim":"map","args":[{"prim":"string"},{"prim":"bytes"}]},{"prim":"nat"}]}]}]}]}]},{"prim":"pair","args":[{"prim":"pair","args":[{"prim":"pair","args":[{"prim":"address"},{"prim":"nat"}]},{"prim":"pair","args":[{"prim":"set","args":[{"prim":"address"}]},{"prim":"big_map","args":[{"prim":"pair","args":[{"prim":"address"},{"prim":"nat"}]},{"prim":"nat"}]}]}]},{"prim":"pair","args":[{"prim":"pair","args":[{"prim":"big_map","args":[{"prim":"string"},{"prim":"bytes"}]},{"prim":"big_map","args":[{"prim":"nat"},{"prim":"address"}]}]},{"prim":"pair","args":[{"prim":"big_map","args":[{"prim":"pair","args":[{"prim":"address"},{"prim":"pair","args":[{"prim":"address"},{"prim":"nat"}]}]},{"prim":"unit"}]},{"prim":"pair","args":[{"prim":"big_map","args":[{"prim":"nat"},{"prim":"pair","args":[{"prim":"nat"},{"prim":"map","args":[{"prim":"string"},{"prim":"bytes"}]}]}]},{"prim":"big_map","args":[{"prim":"nat"},{"prim":"nat"}]}]}]}]}]}]}]},{"prim":"UNPAIR"},{"prim":"IF_LEFT","args":[[{"prim":"IF_LEFT","args":[[{"prim":"IF_LEFT","args":[[{"prim":"DUP","args":[{"int":"2"}]},{"prim":"CAR"},{"prim":"CAR"},{"prim":"CAR"},{"prim":"SENDER"},{"prim":"COMPARE"},{"prim":"EQ"},{"prim":"IF","args":[[],[{"prim":"PUSH","args":[{"prim":"string"},{"string":"FA2_NOT_ADMIN"}]},{"prim":"FAILWITH"}]]},{"prim":"DUP"},{"prim":"ITER","args":[[{"prim":"DIG","args":[{"int":"2"}]},{"prim":"UNPAIR"},{"prim":"UNPAIR"},{"prim":"SWAP"},{"prim":"UNPAIR"},{"prim":"PUSH","args":[{"prim":"bool"},{"prim":"True"}]},{"prim":"DIG","args":[{"int":"5"}]},{"prim":"UPDATE"},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"PAIR"},{"prim":"SWAP"}]]},{"prim":"DROP"}],[{"prim":"DUP","args":[{"int":"2"}]},{"prim":"GET","args":[{"int":"7"}]},{"prim":"DUP","args":[{"int":"2"}]},{"prim":"GET","args":[{"int":"3"}]},{"prim":"MEM"},{"prim":"IF","args":[[],[{"prim":"PUSH","args":[{"prim":"string"},{"string":"FA2_TOKEN_UNDEFINED"}]},{"prim":"FAILWITH"}]]},{"prim":"DUP","args":[{"int":"2"}]},{"prim":"CAR"},{"prim":"CAR"},{"prim":"CAR"},{"prim":"SENDER"},{"prim":"COMPARE"},{"prim":"EQ"},{"prim":"IF","args":[[{"prim":"PUSH","args":[{"prim":"bool"},{"prim":"True"}]}],[{"prim":"DUP","args":[{"int":"2"}]},{"prim":"CAR"},{"prim":"GET","args":[{"int":"3"}]},{"prim":"SENDER"},{"prim":"MEM"}]]},{"prim":"IF","args":[[],[{"prim":"PUSH","args":[{"prim":"string"},{"string":"FA2_NOT_ADMIN_OR_OPERATOR"}]},{"prim":"FAILWITH"}]]},{"prim":"DUP","args":[{"int":"2"}]},{"prim":"GET","args":[{"int":"3"}]},{"prim":"CDR"},{"prim":"DUP","args":[{"int":"2"}]},{"prim":"GET","args":[{"int":"3"}]},{"prim":"GET"},{"prim":"IF_NONE","args":[[{"prim":"DUP","args":[{"int":"2"}]},{"prim":"CAR"},{"prim":"CAR"},{"prim":"CAR"}],[]]},{"prim":"SENDER"},{"prim":"COMPARE"},{"prim":"EQ"},{"prim":"IF","args":[[],[{"prim":"PUSH","args":[{"prim":"string"},{"string":"FA2_NOT_OWNER"}]},{"prim":"FAILWITH"}]]},{"prim":"DUP","args":[{"int":"2"}]},{"prim":"CAR"},{"prim":"GET","args":[{"int":"4"}]},{"prim":"DUP","args":[{"int":"2"}]},{"prim":"GET","args":[{"int":"3"}]},{"prim":"SENDER"},{"prim":"PAIR"},{"prim":"GET"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"0"}]}],[]]},{"prim":"DUP","args":[{"int":"3"}]},{"prim":"GET","args":[{"int":"8"}]},{"prim":"DUP","args":[{"int":"3"}]},{"prim":"GET","args":[{"int":"3"}]},{"prim":"GET"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"int"},{"int":"534"}]},{"prim":"FAILWITH"}],[]]},{"prim":"COMPARE"},{"prim":"EQ"},{"prim":"IF","args":[[],[{"prim":"PUSH","args":[{"prim":"string"},{"string":"FA2_INSUFFICIENT_BALANCE"}]},{"prim":"FAILWITH"}]]},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"0"}]},{"prim":"DUP","args":[{"int":"2"}]},{"prim":"GET","args":[{"int":"4"}]},{"prim":"SIZE"},{"prim":"COMPARE"},{"prim":"GT"},{"prim":"IF","args":[[{"prim":"DUP","args":[{"int":"2"}]},{"prim":"GET","args":[{"int":"7"}]},{"prim":"DUP","args":[{"int":"2"}]},{"prim":"GET","args":[{"int":"3"}]},{"prim":"GET"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"int"},{"int":"536"}]},{"prim":"FAILWITH"}],[]]},{"prim":"CDR"},{"prim":"DUP","args":[{"int":"2"}]},{"prim":"CAR"},{"prim":"MEM"}],[{"prim":"PUSH","args":[{"prim":"bool"},{"prim":"False"}]}]]},{"prim":"IF","args":[[{"prim":"SWAP"},{"prim":"DUP"},{"prim":"GET","args":[{"int":"7"}]},{"prim":"DUP"},{"prim":"DUP","args":[{"int":"4"}]},{"prim":"GET","args":[{"int":"3"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"2"}]},{"prim":"GET"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"int"},{"int":"537"}]},{"prim":"FAILWITH"}],[]]},{"prim":"DUP"},{"prim":"CDR"},{"prim":"DUP"},{"prim":"DUP","args":[{"int":"7"}]},{"prim":"CAR"},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"2"}]},{"prim":"GET"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"int"},{"int":"537"}]},{"prim":"FAILWITH"}],[]]},{"prim":"DIG","args":[{"int":"7"}]},{"prim":"GET","args":[{"int":"4"}]},{"prim":"SWAP"},{"prim":"CONCAT"},{"prim":"SOME"},{"prim":"SWAP"},{"prim":"UPDATE"},{"prim":"UPDATE","args":[{"int":"2"}]},{"prim":"SOME"},{"prim":"SWAP"},{"prim":"UPDATE"},{"prim":"UPDATE","args":[{"int":"7"}]}],[{"prim":"SWAP"},{"prim":"DUP"},{"prim":"GET","args":[{"int":"7"}]},{"prim":"DUP"},{"prim":"DUP","args":[{"int":"4"}]},{"prim":"GET","args":[{"int":"3"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"2"}]},{"prim":"GET"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"int"},{"int":"539"}]},{"prim":"FAILWITH"}],[]]},{"prim":"DUP"},{"prim":"CDR"},{"prim":"DUP","args":[{"int":"6"}]},{"prim":"GET","args":[{"int":"4"}]},{"prim":"SOME"},{"prim":"DIG","args":[{"int":"6"}]},{"prim":"CAR"},{"prim":"UPDATE"},{"prim":"UPDATE","args":[{"int":"2"}]},{"prim":"SOME"},{"prim":"SWAP"},{"prim":"UPDATE"},{"prim":"UPDATE","args":[{"int":"7"}]}]]}]]},{"prim":"NIL","args":[{"prim":"operation"}]}],[{"prim":"IF_LEFT","args":[[{"prim":"DUP"},{"prim":"CAR"},{"prim":"MAP","args":[[{"prim":"DUP","args":[{"int":"3"}]},{"prim":"GET","args":[{"int":"7"}]},{"prim":"DUP","args":[{"int":"2"}]},{"prim":"CDR"},{"prim":"MEM"},{"prim":"IF","args":[[],[{"prim":"PUSH","args":[{"prim":"string"},{"string":"FA2_TOKEN_UNDEFINED"}]},{"prim":"FAILWITH"}]]},{"prim":"DUP","args":[{"int":"3"}]},{"prim":"CAR"},{"prim":"GET","args":[{"int":"4"}]},{"prim":"DUP","args":[{"int":"2"}]},{"prim":"CDR"},{"prim":"DUP","args":[{"int":"3"}]},{"prim":"CAR"},{"prim":"PAIR"},{"prim":"MEM"},{"prim":"IF","args":[[{"prim":"DUP","args":[{"int":"3"}]},{"prim":"CAR"},{"prim":"GET","args":[{"int":"4"}]},{"prim":"DUP","args":[{"int":"2"}]},{"prim":"CDR"},{"prim":"DUP","args":[{"int":"3"}]},{"prim":"CAR"},{"prim":"PAIR"},{"prim":"GET"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"int"},{"int":"436"}]},{"prim":"FAILWITH"}],[]]},{"prim":"SWAP"},{"prim":"PAIR"}],[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"0"}]},{"prim":"SWAP"},{"prim":"PAIR"}]]}]]},{"prim":"NIL","args":[{"prim":"operation"}]},{"prim":"DIG","args":[{"int":"2"}]},{"prim":"CDR"},{"prim":"PUSH","args":[{"prim":"mutez"},{"int":"0"}]},{"prim":"DIG","args":[{"int":"3"}]},{"prim":"TRANSFER_TOKENS"},{"prim":"CONS"}],[{"prim":"IF_LEFT","args":[[{"prim":"DUP","args":[{"int":"2"}]},{"prim":"GET","args":[{"int":"7"}]},{"prim":"DUP","args":[{"int":"2"}]},{"prim":"CDR"},{"prim":"MEM"},{"prim":"IF","args":[[],[{"prim":"PUSH","args":[{"prim":"string"},{"string":"FA2_TOKEN_UNDEFINED"}]},{"prim":"FAILWITH"}]]},{"prim":"DUP","args":[{"int":"2"}]},{"prim":"UNPAIR"},{"prim":"UNPAIR"},{"prim":"SWAP"},{"prim":"UNPAIR"},{"prim":"SWAP"},{"prim":"DUP","args":[{"int":"5"}]},{"prim":"CAR"},{"prim":"DIG","args":[{"int":"6"}]},{"prim":"CAR"},{"prim":"GET","args":[{"int":"4"}]},{"prim":"DUP","args":[{"int":"7"}]},{"prim":"CDR"},{"prim":"SENDER"},{"prim":"PAIR"},{"prim":"GET"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"0"}]}],[]]},{"prim":"SUB"},{"prim":"ISNAT"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"FA2_INSUFFICIENT_BALANCE"}]},{"prim":"FAILWITH"}],[]]},{"prim":"SOME"},{"prim":"DUP","args":[{"int":"6"}]},{"prim":"CDR"},{"prim":"SENDER"},{"prim":"PAIR"},{"prim":"UPDATE"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"DUP","args":[{"int":"2"}]},{"prim":"DUP"},{"prim":"GET","args":[{"int":"8"}]},{"prim":"DUP","args":[{"int":"3"}]},{"prim":"CAR"},{"prim":"DIG","args":[{"int":"4"}]},{"prim":"GET","args":[{"int":"8"}]},{"prim":"DUP","args":[{"int":"5"}]},{"prim":"CDR"},{"prim":"GET"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"int"},{"int":"613"}]},{"prim":"FAILWITH"}],[]]},{"prim":"SUB"},{"prim":"ISNAT"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"int"},{"int":"613"}]},{"prim":"FAILWITH"}],[]]},{"prim":"SOME"},{"prim":"DUP","args":[{"int":"4"}]},{"prim":"CDR"},{"prim":"UPDATE"},{"prim":"UPDATE","args":[{"int":"8"}]},{"prim":"SWAP"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"0"}]},{"prim":"DUP","args":[{"int":"3"}]},{"prim":"GET","args":[{"int":"8"}]},{"prim":"DUP","args":[{"int":"3"}]},{"prim":"CDR"},{"prim":"GET"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"int"},{"int":"614"}]},{"prim":"FAILWITH"}],[]]},{"prim":"COMPARE"},{"prim":"EQ"},{"prim":"IF","args":[[{"prim":"SWAP"},{"prim":"DUP"},{"prim":"GET","args":[{"int":"7"}]},{"prim":"NONE","args":[{"prim":"pair","args":[{"prim":"nat"},{"prim":"map","args":[{"prim":"string"},{"prim":"bytes"}]}]}]},{"prim":"DIG","args":[{"int":"3"}]},{"prim":"CDR"},{"prim":"UPDATE"},{"prim":"UPDATE","args":[{"int":"7"}]}],[{"prim":"DROP"}]]}],[{"prim":"DUP","args":[{"int":"2"}]},{"prim":"CAR"},{"prim":"CAR"},{"prim":"CAR"},{"prim":"SENDER"},{"prim":"COMPARE"},{"prim":"EQ"},{"prim":"IF","args":[[{"prim":"PUSH","args":[{"prim":"bool"},{"prim":"True"}]}],[{"prim":"DUP","args":[{"int":"2"}]},{"prim":"CAR"},{"prim":"GET","args":[{"int":"3"}]},{"prim":"SENDER"},{"prim":"MEM"}]]},{"prim":"IF","args":[[],[{"prim":"PUSH","args":[{"prim":"string"},{"string":"FA2_NOT_ADMIN_OR_OPERATOR"}]},{"prim":"FAILWITH"}]]},{"prim":"DUP","args":[{"int":"2"}]},{"prim":"UNPAIR"},{"prim":"UNPAIR"},{"prim":"SWAP"},{"prim":"UNPAIR"},{"prim":"SWAP"},{"prim":"DUP","args":[{"int":"5"}]},{"prim":"GET","args":[{"int":"3"}]},{"prim":"SOME"},{"prim":"DIG","args":[{"int":"6"}]},{"prim":"CAR"},{"prim":"CAR"},{"prim":"CDR"},{"prim":"DUP","args":[{"int":"7"}]},{"prim":"CAR"},{"prim":"PAIR"},{"prim":"UPDATE"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"DUP","args":[{"int":"2"}]},{"prim":"DUP"},{"prim":"GET","args":[{"int":"7"}]},{"prim":"DUP","args":[{"int":"3"}]},{"prim":"GET","args":[{"int":"4"}]},{"prim":"DUP","args":[{"int":"5"}]},{"prim":"CAR"},{"prim":"CAR"},{"prim":"CDR"},{"prim":"PAIR"},{"prim":"SOME"},{"prim":"DIG","args":[{"int":"4"}]},{"prim":"CAR"},{"prim":"CAR"},{"prim":"CDR"},{"prim":"UPDATE"},{"prim":"UPDATE","args":[{"int":"7"}]},{"prim":"SWAP"},{"prim":"DUP","args":[{"int":"2"}]},{"prim":"DUP"},{"prim":"GET","args":[{"int":"8"}]},{"prim":"DIG","args":[{"int":"2"}]},{"prim":"GET","args":[{"int":"3"}]},{"prim":"SOME"},{"prim":"DIG","args":[{"int":"3"}]},{"prim":"CAR"},{"prim":"CAR"},{"prim":"CDR"},{"prim":"UPDATE"},{"prim":"UPDATE","args":[{"int":"8"}]},{"prim":"DUP"},{"prim":"CAR"},{"prim":"CAR"},{"prim":"CAR"},{"prim":"SENDER"},{"prim":"COMPARE"},{"prim":"EQ"},{"prim":"IF","args":[[],[{"prim":"DUP"},{"prim":"UNPAIR"},{"prim":"SWAP"},{"prim":"UNPAIR"},{"prim":"UNPAIR"},{"prim":"SWAP"},{"prim":"SENDER"},{"prim":"SOME"},{"prim":"DIG","args":[{"int":"5"}]},{"prim":"CAR"},{"prim":"CAR"},{"prim":"CDR"},{"prim":"UPDATE"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"}]]},{"prim":"UNPAIR"},{"prim":"UNPAIR"},{"prim":"UNPAIR"},{"prim":"SWAP"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"1"}]},{"prim":"ADD"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"PAIR"},{"prim":"PAIR"}]]},{"prim":"NIL","args":[{"prim":"operation"}]}]]}]]}],[{"prim":"IF_LEFT","args":[[{"prim":"IF_LEFT","args":[[{"prim":"DUP","args":[{"int":"2"}]},{"prim":"CAR"},{"prim":"CAR"},{"prim":"CAR"},{"prim":"SENDER"},{"prim":"COMPARE"},{"prim":"EQ"},{"prim":"IF","args":[[],[{"prim":"PUSH","args":[{"prim":"string"},{"string":"FA2_NOT_ADMIN"}]},{"prim":"FAILWITH"}]]},{"prim":"DUP"},{"prim":"ITER","args":[[{"prim":"DIG","args":[{"int":"2"}]},{"prim":"UNPAIR"},{"prim":"UNPAIR"},{"prim":"SWAP"},{"prim":"UNPAIR"},{"prim":"PUSH","args":[{"prim":"bool"},{"prim":"False"}]},{"prim":"DIG","args":[{"int":"5"}]},{"prim":"UPDATE"},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"PAIR"},{"prim":"SWAP"}]]},{"prim":"DROP"}],[{"prim":"DUP"},{"prim":"ITER","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"ITER","args":[[{"prim":"SENDER"},{"prim":"DUP","args":[{"int":"3"}]},{"prim":"CAR"},{"prim":"COMPARE"},{"prim":"EQ"},{"prim":"IF","args":[[{"prim":"PUSH","args":[{"prim":"bool"},{"prim":"True"}]}],[{"prim":"DUP","args":[{"int":"4"}]},{"prim":"GET","args":[{"int":"5"}]},{"prim":"DUP","args":[{"int":"2"}]},{"prim":"GET","args":[{"int":"3"}]},{"prim":"SENDER"},{"prim":"DUP","args":[{"int":"5"}]},{"prim":"CAR"},{"prim":"PAIR","args":[{"int":"3"}]},{"prim":"MEM"}]]},{"prim":"IF","args":[[],[{"prim":"PUSH","args":[{"prim":"string"},{"string":"FA2_NOT_OPERATOR"}]},{"prim":"FAILWITH"}]]},{"prim":"DUP","args":[{"int":"4"}]},{"prim":"GET","args":[{"int":"7"}]},{"prim":"DUP","args":[{"int":"2"}]},{"prim":"GET","args":[{"int":"3"}]},{"prim":"MEM"},{"prim":"IF","args":[[],[{"prim":"PUSH","args":[{"prim":"string"},{"string":"FA2_TOKEN_UNDEFINED"}]},{"prim":"FAILWITH"}]]},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"0"}]},{"prim":"DUP","args":[{"int":"2"}]},{"prim":"GET","args":[{"int":"4"}]},{"prim":"COMPARE"},{"prim":"GT"},{"prim":"IF","args":[[{"prim":"DUP"},{"prim":"GET","args":[{"int":"4"}]},{"prim":"DUP","args":[{"int":"5"}]},{"prim":"CAR"},{"prim":"GET","args":[{"int":"4"}]},{"prim":"DUP","args":[{"int":"3"}]},{"prim":"GET","args":[{"int":"3"}]},{"prim":"DUP","args":[{"int":"5"}]},{"prim":"CAR"},{"prim":"PAIR"},{"prim":"GET"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"int"},{"int":"416"}]},{"prim":"FAILWITH"}],[]]},{"prim":"COMPARE"},{"prim":"GE"},{"prim":"IF","args":[[],[{"prim":"PUSH","args":[{"prim":"string"},{"string":"FA2_INSUFFICIENT_BALANCE"}]},{"prim":"FAILWITH"}]]},{"prim":"DUP"},{"prim":"GET","args":[{"int":"4"}]},{"prim":"DUP","args":[{"int":"5"}]},{"prim":"CAR"},{"prim":"GET","args":[{"int":"4"}]},{"prim":"DUP","args":[{"int":"3"}]},{"prim":"GET","args":[{"int":"3"}]},{"prim":"DUP","args":[{"int":"5"}]},{"prim":"CAR"},{"prim":"PAIR"},{"prim":"GET"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"int"},{"int":"420"}]},{"prim":"FAILWITH"}],[]]},{"prim":"SUB"},{"prim":"ISNAT"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"int"},{"int":"420"}]},{"prim":"FAILWITH"}],[]]},{"prim":"DIG","args":[{"int":"4"}]},{"prim":"UNPAIR"},{"prim":"UNPAIR"},{"prim":"SWAP"},{"prim":"UNPAIR"},{"prim":"SWAP"},{"prim":"DUP"},{"prim":"DUP","args":[{"int":"7"}]},{"prim":"GET","args":[{"int":"3"}]},{"prim":"DUP","args":[{"int":"9"}]},{"prim":"CAR"},{"prim":"PAIR"},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"2"}]},{"prim":"GET"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"int"},{"int":"420"}]},{"prim":"FAILWITH"}],[{"prim":"DROP"}]]},{"prim":"DIG","args":[{"int":"5"}]},{"prim":"SOME"},{"prim":"SWAP"},{"prim":"UPDATE"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"PAIR"},{"prim":"DUG","args":[{"int":"3"}]},{"prim":"DUP","args":[{"int":"4"}]},{"prim":"CAR"},{"prim":"GET","args":[{"int":"4"}]},{"prim":"DUP","args":[{"int":"2"}]},{"prim":"GET","args":[{"int":"3"}]},{"prim":"DUP","args":[{"int":"3"}]},{"prim":"CAR"},{"prim":"PAIR"},{"prim":"MEM"},{"prim":"IF","args":[[{"prim":"DIG","args":[{"int":"3"}]},{"prim":"UNPAIR"},{"prim":"UNPAIR"},{"prim":"SWAP"},{"prim":"UNPAIR"},{"prim":"SWAP"},{"prim":"DUP"},{"prim":"DUP","args":[{"int":"6"}]},{"prim":"GET","args":[{"int":"3"}]},{"prim":"DUP","args":[{"int":"7"}]},{"prim":"CAR"},{"prim":"PAIR"},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"2"}]},{"prim":"GET"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"int"},{"int":"423"}]},{"prim":"FAILWITH"}],[]]},{"prim":"DIG","args":[{"int":"6"}]},{"prim":"GET","args":[{"int":"4"}]},{"prim":"ADD"},{"prim":"SOME"},{"prim":"SWAP"},{"prim":"UPDATE"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"PAIR"},{"prim":"DUG","args":[{"int":"2"}]}],[{"prim":"DIG","args":[{"int":"3"}]},{"prim":"UNPAIR"},{"prim":"UNPAIR"},{"prim":"SWAP"},{"prim":"UNPAIR"},{"prim":"SWAP"},{"prim":"DUP","args":[{"int":"5"}]},{"prim":"GET","args":[{"int":"4"}]},{"prim":"SOME"},{"prim":"DUP","args":[{"int":"6"}]},{"prim":"GET","args":[{"int":"3"}]},{"prim":"DIG","args":[{"int":"6"}]},{"prim":"CAR"},{"prim":"PAIR"},{"prim":"UPDATE"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"PAIR"},{"prim":"DUG","args":[{"int":"2"}]}]]}],[{"prim":"DROP"}]]}]]},{"prim":"DROP"}]]},{"prim":"DROP"}]]}],[{"prim":"IF_LEFT","args":[[{"prim":"DUP","args":[{"int":"2"}]},{"prim":"CAR"},{"prim":"CAR"},{"prim":"CAR"},{"prim":"SENDER"},{"prim":"COMPARE"},{"prim":"EQ"},{"prim":"IF","args":[[],[{"prim":"PUSH","args":[{"prim":"string"},{"string":"FA2_NOT_ADMIN"}]},{"prim":"FAILWITH"}]]},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"0"}]},{"prim":"DUP","args":[{"int":"3"}]},{"prim":"CAR"},{"prim":"CAR"},{"prim":"CDR"},{"prim":"COMPARE"},{"prim":"EQ"},{"prim":"IF","args":[[],[{"prim":"PUSH","args":[{"prim":"string"},{"string":"FA2_INSUFFICIENT_BALANCE"}]},{"prim":"FAILWITH"}]]},{"prim":"SWAP"},{"prim":"UNPAIR"},{"prim":"SWAP"},{"prim":"UNPAIR"},{"prim":"UNPAIR"},{"prim":"DIG","args":[{"int":"4"}]},{"prim":"SOME"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"content"}]},{"prim":"UPDATE"},{"prim":"PAIR"},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"}],[{"prim":"IF_LEFT","args":[[{"prim":"DUP"},{"prim":"ITER","args":[[{"prim":"IF_LEFT","args":[[{"prim":"SENDER"},{"prim":"DUP","args":[{"int":"2"}]},{"prim":"CAR"},{"prim":"COMPARE"},{"prim":"EQ"},{"prim":"IF","args":[[],[{"prim":"PUSH","args":[{"prim":"string"},{"string":"FA2_NOT_OWNER"}]},{"prim":"FAILWITH"}]]},{"prim":"DIG","args":[{"int":"2"}]},{"prim":"DUP"},{"prim":"GET","args":[{"int":"5"}]},{"prim":"PUSH","args":[{"prim":"option","args":[{"prim":"unit"}]},{"prim":"Some","args":[{"prim":"Unit"}]}]},{"prim":"DIG","args":[{"int":"3"}]},{"prim":"DUP"},{"prim":"GET","args":[{"int":"4"}]},{"prim":"SWAP"},{"prim":"DUP"},{"prim":"GET","args":[{"int":"3"}]},{"prim":"SWAP"},{"prim":"CAR"},{"prim":"PAIR","args":[{"int":"3"}]},{"prim":"UPDATE"},{"prim":"UPDATE","args":[{"int":"5"}]},{"prim":"SWAP"}],[{"prim":"SENDER"},{"prim":"DUP","args":[{"int":"2"}]},{"prim":"CAR"},{"prim":"COMPARE"},{"prim":"EQ"},{"prim":"IF","args":[[],[{"prim":"PUSH","args":[{"prim":"string"},{"string":"FA2_NOT_OWNER"}]},{"prim":"FAILWITH"}]]},{"prim":"DIG","args":[{"int":"2"}]},{"prim":"DUP"},{"prim":"GET","args":[{"int":"5"}]},{"prim":"NONE","args":[{"prim":"unit"}]},{"prim":"DIG","args":[{"int":"3"}]},{"prim":"DUP"},{"prim":"GET","args":[{"int":"4"}]},{"prim":"SWAP"},{"prim":"DUP"},{"prim":"GET","args":[{"int":"3"}]},{"prim":"SWAP"},{"prim":"CAR"},{"prim":"PAIR","args":[{"int":"3"}]},{"prim":"UPDATE"},{"prim":"UPDATE","args":[{"int":"5"}]},{"prim":"SWAP"}]]}]]},{"prim":"DROP"}],[{"prim":"DUP","args":[{"int":"2"}]},{"prim":"GET","args":[{"int":"7"}]},{"prim":"DUP","args":[{"int":"2"}]},{"prim":"CDR"},{"prim":"MEM"},{"prim":"IF","args":[[],[{"prim":"PUSH","args":[{"prim":"string"},{"string":"FA2_TOKEN_UNDEFINED"}]},{"prim":"FAILWITH"}]]},{"prim":"DUP","args":[{"int":"2"}]},{"prim":"CAR"},{"prim":"CAR"},{"prim":"CAR"},{"prim":"SENDER"},{"prim":"COMPARE"},{"prim":"EQ"},{"prim":"IF","args":[[{"prim":"PUSH","args":[{"prim":"bool"},{"prim":"True"}]}],[{"prim":"DUP","args":[{"int":"2"}]},{"prim":"CAR"},{"prim":"GET","args":[{"int":"3"}]},{"prim":"SENDER"},{"prim":"MEM"}]]},{"prim":"IF","args":[[],[{"prim":"PUSH","args":[{"prim":"string"},{"string":"FA2_NOT_ADMIN_OR_OPERATOR"}]},{"prim":"FAILWITH"}]]},{"prim":"DUP","args":[{"int":"2"}]},{"prim":"GET","args":[{"int":"3"}]},{"prim":"CDR"},{"prim":"DUP","args":[{"int":"2"}]},{"prim":"CDR"},{"prim":"GET"},{"prim":"IF_NONE","args":[[{"prim":"DUP","args":[{"int":"2"}]},{"prim":"CAR"},{"prim":"CAR"},{"prim":"CAR"}],[]]},{"prim":"SENDER"},{"prim":"COMPARE"},{"prim":"EQ"},{"prim":"IF","args":[[],[{"prim":"PUSH","args":[{"prim":"string"},{"string":"FA2_NOT_OWNER"}]},{"prim":"FAILWITH"}]]},{"prim":"DUP","args":[{"int":"2"}]},{"prim":"CAR"},{"prim":"GET","args":[{"int":"4"}]},{"prim":"DUP","args":[{"int":"2"}]},{"prim":"CDR"},{"prim":"SENDER"},{"prim":"PAIR"},{"prim":"GET"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"0"}]}],[]]},{"prim":"DUP","args":[{"int":"3"}]},{"prim":"GET","args":[{"int":"8"}]},{"prim":"DUP","args":[{"int":"3"}]},{"prim":"CDR"},{"prim":"GET"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"int"},{"int":"549"}]},{"prim":"FAILWITH"}],[]]},{"prim":"COMPARE"},{"prim":"EQ"},{"prim":"IF","args":[[],[{"prim":"PUSH","args":[{"prim":"string"},{"string":"FA2_INSUFFICIENT_BALANCE"}]},{"prim":"FAILWITH"}]]},{"prim":"DUP","args":[{"int":"2"}]},{"prim":"GET","args":[{"int":"7"}]},{"prim":"DUP","args":[{"int":"2"}]},{"prim":"CDR"},{"prim":"GET"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"int"},{"int":"551"}]},{"prim":"FAILWITH"}],[]]},{"prim":"DUP","args":[{"int":"2"}]},{"prim":"CAR"},{"prim":"ITER","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"0"}]},{"prim":"DUP","args":[{"int":"2"}]},{"prim":"CDR"},{"prim":"SIZE"},{"prim":"COMPARE"},{"prim":"GT"},{"prim":"IF","args":[[{"prim":"SWAP"},{"prim":"DUP"},{"prim":"CDR"},{"prim":"DUP","args":[{"int":"3"}]},{"prim":"CDR"},{"prim":"SOME"},{"prim":"DIG","args":[{"int":"3"}]},{"prim":"CAR"},{"prim":"UPDATE"},{"prim":"UPDATE","args":[{"int":"2"}]}],[{"prim":"SWAP"},{"prim":"DUP"},{"prim":"CDR"},{"prim":"NONE","args":[{"prim":"bytes"}]},{"prim":"DIG","args":[{"int":"3"}]},{"prim":"CAR"},{"prim":"UPDATE"},{"prim":"UPDATE","args":[{"int":"2"}]}]]}]]},{"prim":"DIG","args":[{"int":"2"}]},{"prim":"DUP"},{"prim":"GET","args":[{"int":"7"}]},{"prim":"DIG","args":[{"int":"2"}]},{"prim":"SOME"},{"prim":"DIG","args":[{"int":"3"}]},{"prim":"CDR"},{"prim":"UPDATE"},{"prim":"UPDATE","args":[{"int":"7"}]}]]}]]}]]},{"prim":"NIL","args":[{"prim":"operation"}]}]]},{"prim":"PAIR"}]]}],"storage":{"prim":"Pair","args":[{"prim":"Pair","args":[{"prim":"Pair","args":[{"string":"${user_address}"},{"int":"0"}]},{"prim":"Pair","args":[[],[]]}]},{"prim":"Pair","args":[{"prim":"Pair","args":[[{"prim":"Elt","args":[{"string":""},{"bytes":"74657a6f732d73746f726167653a636f6e74656e74"}]},{"prim":"Elt","args":[{"string":"content"},{"bytes":"${metadata_content}"}]}],[]]},{"prim":"Pair","args":[[],{"prim":"Pair","args":[[],[]]}]}]}]}}',I="ZeroTerminal",f=20480;let T,h="";async function v(e){let t="sort.desc=lastActivity&select=address,tokensCount,firstActivityTime,typeHash,creator&typeHash"+(u.indexOf(",")>=0?".in":"")+"="+u+(h?"":"&tokensCount.gt=0")+(e.address?"&address="+e.address:"")+(e.creator?"&creator="+e.creator:"")+(e.limit?"&limit="+e.limit:"")+(e.offset?"&offset="+e.offset:"");try{let e=await fetch("https://api."+l+".tzkt.io/v1/contracts?"+t);if(e.ok)return await e.json();console.log("ERROR "+n()+"(): can't get collections")}catch(e){console.log("ERROR "+n()+"(): "+e+JSON.stringify(e))}}async function A(e){let t="includeStorage=true&address="+e;try{let e=await fetch("https://api."+l+".tzkt.io/v1/contracts?"+t);if(e.ok){let t=await e.json();return t&&t.length>0?t[0]:t}console.log("ERROR "+n()+"(): can't get collection")}catch(e){console.log("ERROR "+n()+"(): "+e+JSON.stringify(e))}}async function S(e){try{let t=await fetch("https://api."+l+".tzkt.io/v1/contracts/"+e+"/bigmaps/metadata/keys?key=content&select=value");if(t.ok)return(await t.json())[0];console.log("ERROR "+n()+"(): can't get collection metadata")}catch(e){console.log("ERROR "+n()+"(): "+e+JSON.stringify(e))}}async function P(e,t){let r="sort.desc=id&active=true&select=key,value"+(e?"&value.token.address="+e:"")+(t?"&value.token.id="+t:"");try{let e=await fetch("https://api."+l+".tzkt.io/v1/contracts/"+p+"/bigmaps/offers/keys?"+r);if(e.ok){let t=await e.json();if(t&&t.length>0){let e=null;for(let r of t)r.value.seller!==h&&(e?Number(e.value.price)>=Number(r.value.price)&&(e=r):e=r);return e}}else console.log("ERROR "+n()+"(): can't get best offer")}catch(e){console.log("ERROR "+n()+"(): "+e+JSON.stringify(e))}}async function b(e){let t="sort.desc=id&select=contract,tokenId,totalSupply,firstMinter,metadata&totalSupply.gt=0&standard=fa2"+(e.limit?"&limit="+e.limit:"")+(e.offset?"&offset="+e.offset:"")+(e.contract?"&contract.in="+e.contract:"")+(e.tokenId?"&tokenId="+e.tokenId:"")+(e.minter?"&firstMinter="+e.minter:"")+(e.name?"&metadata.name="+encodeURIComponent(e.name):"")+(e.onchain?"&metadata.artifactUri.as=data:"+(e.type?e.type:"")+"*":"&metadata.artifactUri.null=false");if(Array.isArray(e.creators)&&e.creators.length>0){e.creators.sort(),t+="&metadata.creators.as=*";for(let r of e.creators)t+='"'+r+'"*'}if(Array.isArray(e.tags)&&e.tags.length>0){e.tags.sort(((e,t)=>e.localeCompare(t))),t+="&metadata.tags.as=*";for(let r of e.tags)t+='"'+encodeURIComponent(r)+'"*'}try{let e=await fetch("https://api."+l+".tzkt.io/v1/tokens?"+t);if(e.ok)return await e.json();console.log("ERROR "+n()+"(): can't get tokens")}catch(e){console.log("ERROR "+n()+"(): "+e+JSON.stringify(e))}}async function R(e,t){let r="limit=1&select=account.address as account,token,balance,firstTime&token.contract="+e+"&token.tokenid="+t;try{let e=await fetch("https://api."+l+".tzkt.io/v1/tokens/balances?"+r+"&account="+h);if(e.ok){let t=await e.json();if(t.length>0)return t[0];{let e=await fetch("https://api."+l+".tzkt.io/v1/tokens/balances?"+r);if(e.ok){if(t=await e.json(),t.length>0)return t[0].account=h,t[0].balance=0,t[0]}else console.log("ERROR "+n()+"(): can't get token")}}else console.log("ERROR "+n()+"(): can't get token balance")}catch(e){console.log("ERROR "+n()+"(): "+e+JSON.stringify(e))}}async function L(t,r,i){let a="";if((i=new Map([...i].sort())).size>0){let t=!0;for(let[r,s]of i)t?t=!1:a+=",",a+='{"prim":"Elt","args":[{"string":"'+r+'"},{"bytes":"'+e("string"==typeof s||s instanceof String?s:JSON.stringify(s))+'"}]}'}let s='{"string":"'+h+'"}',o='{"int":"'+r+'"}',m="["+a+"]",d=[];try{let e='{"prim":"Pair","args":[${0},{"prim":"Pair","args":[${1},${2}]}]}';try{let r=await fetch("https://api."+l+".tzkt.io/v1/contracts/"+t+"/entrypoints/mint"),i=await r.json();2===Object.keys(i.jsonParameters["schema:object"]).length&&(e='{"prim":"Pair","args":[${0},${1}]}');for(let e of Object.keys(i.jsonParameters["schema:object"]))e.endsWith(":address")?d.push(s):e.endsWith(":nat")?d.push(o):e.endsWith(":map_flat:string:bytes")&&d.push(m)}catch(e){console.log("ERROR "+n()+"(): "+e+" "+JSON.stringify(e))}for(let t=0;t<d.length;t++)e=e.replace("${"+t+"}",d[t]);let r=await T.requestOperation({operationDetails:[{kind:beacon.TezosOperationType.TRANSACTION,amount:0,destination:t,parameters:{entrypoint:"mint",value:JSON.parse(e)}}]});if(r.transactionHash)return r.transactionHash}catch(e){console.log("ERROR "+n()+"(): "+e+" "+JSON.stringify(e))}}async function D(t,r,i){let a="";if((i=new Map([...i].sort())).size>0){let t=!0;for(let[r,s]of i)t?t=!1:a+=",",a+='{"prim":"Elt","args":[{"string":"'+r+'"},{"bytes":"'+e("string"==typeof s||s instanceof String?s:JSON.stringify(s))+'"}]}'}try{let e=await T.requestOperation({operationDetails:[{kind:beacon.TezosOperationType.TRANSACTION,amount:0,destination:t,parameters:{entrypoint:"update_token_metadata",value:JSON.parse('{"prim":"Pair","args":[['+a+'],{"int":"'+r+'"}]}')}}]});if(e.transactionHash)return e.transactionHash;console.log("ERROR "+n()+"(): can't edit token")}catch(e){console.log("ERROR "+n()+"(): "+e+JSON.stringify(e))}}async function k(e){try{let t=await fetch("https://api."+l+".tzkt.io/v1/operations/transactions/"+e+"/status");if(t.ok){const e=await t.text();if(e)return JSON.parse(e)}else console.log("ERROR "+n()+"(): can't get status for "+e)}catch(e){console.log("ERRROR "+n()+"(): "+e+" "+JSON.stringify(e))}return null}const U={message:"The address is copied",type:"is-success"};var N,B,C,O=0,w=0,j="",q="";async function F(){document.getElementById("btnMoreActiveTokens").classList.add("is-loading");let e=document.getElementById("dActiveTokens"),t=0,r=new URLSearchParams(window.location.search),i=await async function(e){let t="sort.desc=lastActivity&select=contract,tokenId,totalSupply,firstMinter,metadata&totalSupply.gt=0&standard=fa2"+(e.limit?"&limit="+e.limit:"")+(e.offset?"&offset="+e.offset:"")+(e.onchain?"&metadata.artifactUri.as=data:"+(e.type?e.type:"")+"*":"&metadata.artifactUri.null=false");try{let e=await fetch("https://api."+l+".tzkt.io/v1/tokens?"+t);if(e.ok)return await e.json();console.log("ERROR "+n()+"(): can't get tokens")}catch(e){console.log("ERROR "+n()+"(): "+e+JSON.stringify(e))}}({limit:20,offset:w,onchain:"false"!==r.get("onchain")});if(document.getElementById("dActiveTokensLoader").classList.add("is-hidden"),i){for(let r of i){t++;let i=r.token?r.token:r,a=await _(i);a&&e.append(a)}t<20?document.getElementById("dMoreActiveTokens").classList.add("is-hidden"):document.getElementById("dMoreActiveTokens").classList.remove("is-hidden"),document.getElementById("btnMoreActiveTokens").classList.remove("is-loading"),0===(w+=t)&&(e.textContent="There are no on-chain tokens yet.")}else re()}async function M(){document.getElementById("btnMoreCollections").classList.add("is-loading");let e=document.getElementById("dCollections"),a=0,s=new URLSearchParams(window.location.search),n=s.get("cid"),o=s.get("creator"),m=await v({creator:o,address:n,limit:15,offset:O});if(document.getElementById("dCollectionsLoader").classList.add("is-hidden"),m){for(let s of m){if(a++,h&&h!==s.creator.address&&0===s.tokensCount)continue;let n=await S(s.address);if(n)try{n=JSON.parse(t(n))}catch(e){continue}const o=document.getElementById("t-collection").content.cloneNode(!0);let m=n?.imageUri;if(m){try{new URL(m),m=m.replace("ipfs://","https://ipfs.io/ipfs/")}catch(e){}o.querySelector(".js-img").setAttribute("src",m)}o.querySelector(".js-name").innerText=n?.name,o.querySelector(".js-description").innerText=n?.description,o.querySelector(".js-address").prepend(document.createTextNode(r(s.address))),o.querySelector(".copy-item").addEventListener("click",(()=>{s.address&&i(s.address)&&bulmaToast.toast(U)})),o.querySelector(".js-count").innerText=s.tokensCount,o.querySelectorAll(".js-collection-item").forEach((function(e){e.setAttribute("href",window.location.pathname+"?cmd=tokens&cid="+s.address)})),e.append(o)}a<15?document.getElementById("dMoreCollections").classList.add("is-hidden"):document.getElementById("dMoreCollections").classList.remove("is-hidden"),document.getElementById("btnMoreCollections").classList.remove("is-loading"),0===(O+=a)&&(e.textContent="There are no on-chain collections yet.")}else re()}async function H(){document.getElementById("btnMoreTokens").classList.add("is-loading");let e,t=document.getElementById("dTokens"),r=0,i=new URLSearchParams(window.location.search);if(e=i.get("account")?await async function(e){let t="sort.desc=id&select=account,token,balance&balance.gt=0&token.standard=fa2"+(e.account?"&account="+e.account:"")+(e.limit?"&limit="+e.limit:"")+(e.offset?"&offset="+e.offset:"")+(e.onchain?"&token.metadata.artifactUri.as=data:*":"&token.metadata.artifactUri.null=false");try{let e=await fetch("https://api."+l+".tzkt.io/v1/tokens/balances?"+t);if(e.ok)return await e.json();console.log("ERROR "+n()+"(): can't get tokens")}catch(e){console.log("ERROR "+n()+"(): "+e+JSON.stringify(e))}}({account:i.get("account"),limit:20,offset:w,onchain:"false"!==i.get("onchain")}):await b({limit:20,offset:w,contract:i.get("cid"),name:i.get("name"),creators:i.getAll("creator"),tags:i.getAll("tag"),type:i.get("type"),minter:i.get("minter"),onchain:"false"!==i.get("onchain")}),document.getElementById("dTokensLoader").classList.add("is-hidden"),e){for(let i of e){r++;let e=i.token?i.token:i,a=await _(e);a&&t.append(a)}r<20?document.getElementById("dMoreTokens").classList.add("is-hidden"):document.getElementById("dMoreTokens").classList.remove("is-hidden"),document.getElementById("btnMoreTokens").classList.remove("is-loading"),0===(w+=r)&&(t.textContent="There are no on-chain tokens yet.")}else re()}async function _(e){if("0"===e.totalSupply)return null;let t;const i=document.getElementById("t-token").content.cloneNode(!0);let a=i.querySelector(".js-price");new Promise((t=>{setTimeout((()=>{t(Promise.all([P(e.contract.address,e.tokenId),a]))}),100)})).then((e=>{e[0]&&(e[1].innerText=(parseFloat(e[0].value.price)/1e6).toFixed(2),e[1].parentNode.classList.remove("is-hidden"))}));let s=e.metadata?.name;t=i.querySelector(".js-name"),t.innerText=s||"";let n=e.firstMinter?.address,o=e.firstMinter?.alias;if(s=e.metadata?.creators,!Array.isArray(s))try{s=JSON.parse(s)}catch(e){}let m=i.querySelector(".js-creator");if(Array.isArray(s)&&s.length>0){let e=n&&s.includes(n)?n:s[0],t=e!==n?r(s[0]):o||r(n),a=i.querySelector(".js-creators");s.length>1?a.querySelector(".js-creators-link").append(document.createTextNode("+"+(s.length-1)+"...")):a.remove(),m.querySelector(".js-creator-link").append(document.createTextNode(t)),m.querySelector(".js-creator-link").setAttribute("href",window.location.pathname+"?cmd=tokens&creator="+e),m.classList.remove("is-hidden")}else m.remove();if(s=e.totalSupply,t=i.querySelector(".js-count"),t.innerText=s||"",s=e.metadata?.thumbnailUri?e.metadata?.thumbnailUri:e.metadata?.displayUri?e.metadata?.displayUri:e.metadata?.artifactUri,s){try{new URL(s),s=s.replace("ipfs://","https://ipfs.io/ipfs/")}catch(e){}let t=ee(s);t||(t=e.metadata?.mimeType),t?t.startsWith("image")?(i.querySelector(".js-audio").remove(),i.querySelector(".js-video").remove(),i.querySelector(".js-text").remove(),i.querySelector(".js-data").remove(),i.querySelector(".js-img").setAttribute("src",s),i.querySelector(".js-img").classList.remove("is-hidden")):t.startsWith("audio")?(i.querySelector(".js-img").remove(),i.querySelector(".js-video").remove(),i.querySelector(".js-text").remove(),i.querySelector(".js-data").remove(),i.querySelector(".js-audio").setAttribute("src",s),i.querySelector(".js-audio").classList.remove("is-hidden")):t.startsWith("video")?(i.querySelector(".js-img").remove(),i.querySelector(".js-audio").remove(),i.querySelector(".js-text").remove(),i.querySelector(".js-data").remove(),i.querySelector(".js-video").setAttribute("src",s),i.querySelector(".js-video").classList.remove("is-hidden")):t.startsWith("text")?(i.querySelector(".js-img").remove(),i.querySelector(".js-audio").remove(),i.querySelector(".js-video").remove(),i.querySelector(".js-data").remove(),i.querySelector(".js-text").classList.remove("is-hidden")):(i.querySelector(".js-img").remove(),i.querySelector(".js-audio").remove(),i.querySelector(".js-video").remove(),i.querySelector(".js-text").remove(),i.querySelector(".js-data").classList.remove("is-hidden")):(i.querySelector(".js-audio").remove(),i.querySelector(".js-video").remove(),i.querySelector(".js-text").remove(),i.querySelector(".js-data").remove(),i.querySelector(".js-img").setAttribute("src",s),i.querySelector(".js-img").classList.remove("is-hidden"))}return i.querySelectorAll(".js-token-item").forEach((function(t){t.setAttribute("href",window.location.pathname+"?cmd=token&cid="+e.contract.address+"&tid="+e.tokenId)})),i}async function W(){let e=document.getElementById("dListings"),t=new URLSearchParams(window.location.search),r=t.get("seller"),i=t.get("minprice"),a=t.get("maxprice"),s=t.get("cid"),o=t.get("tid");document.getElementById("btnMoreListings").classList.add("is-loading");let m=0,d=await async function(e,t,r,i,a,s,o){let m="sort.desc=id&active=true&select=key,value&limit=15"+(o?"&offset="+o:"")+(e?"&value.seller="+e:"")+(t?"&value.price.ge="+t:"")+(r?"&value.price.le="+r:"")+(i?"&value.token.address="+i:"")+(a?"&value.token.id="+a:"");try{let e=await fetch("https://api."+l+".tzkt.io/v1/contracts/"+p+"/bigmaps/offers/keys?"+m);if(e.ok)return await e.json();console.log("ERROR "+n()+"(): can't get offers")}catch(e){console.log("ERROR "+n()+"(): "+e+JSON.stringify(e))}}(r,i,a,s,o,0,w);if(document.getElementById("dListingsLoader").classList.add("is-hidden"),d){for(let t of d){m++;let r=await G(t);e.append(r)}m<15?document.getElementById("dMoreListings").classList.add("is-hidden"):document.getElementById("dMoreListings").classList.remove("is-hidden"),document.getElementById("btnMoreListings").classList.remove("is-loading"),0===(w+=m)&&(e.textContent="There are no listings matching these criteria.")}else re()}async function G(e){let t;const i=document.getElementById("t-listing").content.cloneNode(!0);let a=(await R(e.value.token.address,e.value.token.id)).token,s=a.metadata?.name;t=i.querySelector(".js-name"),t.innerText=s||"";let o=i.querySelector(".js-creators"),m=i.querySelector(".js-creator");s=a.metadata?.creators;try{s=JSON.parse(s);for(let e=0;e<s.length;e++)t=m.cloneNode(!0),t.setAttribute("href",window.location.pathname+"?cmd=tokens&creator="+s[e]),t.append(document.createTextNode(r(s[e]))),e>0&&o.append(document.createTextNode(", ")),t.classList.remove("is-hidden"),o.append(t)}catch(e){i.querySelector(".js-creators").innerText=""}if(m.remove(),s=new Date(Date.parse(e.value.time_start)).toLocaleString(),t=i.querySelector(".js-start-time"),t.innerText=s||"",s=e.value.time_expiry?new Date(Date.parse(e.value.time_expiry))?.toLocaleString():"...",t=i.querySelector(".js-expiry-time"),t.innerText=s||"",s=e.value.amount,t=i.querySelector(".js-amount"),t.innerText=s||"",s=(parseFloat(e.value.price)/1e6).toFixed(2),t=i.querySelector(".js-price"),t.innerText=s||"",s=a.metadata?.thumbnailUri?a.metadata?.thumbnailUri:a.metadata?.displayUri?a.metadata?.displayUri:a.metadata?.artifactUri,s){try{new URL(s),s=s.replace("ipfs://","https://ipfs.io/ipfs/")}catch(e){}let e=ee(s);e||(e=a.metadata?.mimeType),e?e.startsWith("image")?(i.querySelector(".js-audio").remove(),i.querySelector(".js-video").remove(),i.querySelector(".js-text").remove(),i.querySelector(".js-data").remove(),i.querySelector(".js-img").setAttribute("src",s),i.querySelector(".js-img").classList.remove("is-hidden")):e.startsWith("audio")?(i.querySelector(".js-img").remove(),i.querySelector(".js-video").remove(),i.querySelector(".js-text").remove(),i.querySelector(".js-data").remove(),i.querySelector(".js-audio").setAttribute("src",s),i.querySelector(".js-audio").classList.remove("is-hidden")):e.startsWith("video")?(i.querySelector(".js-img").remove(),i.querySelector(".js-audio").remove(),i.querySelector(".js-text").remove(),i.querySelector(".js-data").remove(),i.querySelector(".js-video").setAttribute("src",s),i.querySelector(".js-video").classList.remove("is-hidden")):e.startsWith("text")?(i.querySelector(".js-img").remove(),i.querySelector(".js-audio").remove(),i.querySelector(".js-video").remove(),i.querySelector(".js-data").remove(),i.querySelector(".js-text").classList.remove("is-hidden")):(i.querySelector(".js-img").remove(),i.querySelector(".js-audio").remove(),i.querySelector(".js-video").remove(),i.querySelector(".js-text").remove(),i.querySelector(".js-data").classList.remove("is-hidden")):(i.querySelector(".js-audio").remove(),i.querySelector(".js-video").remove(),i.querySelector(".js-text").remove(),i.querySelector(".js-data").remove(),i.querySelector(".js-img").setAttribute("src",s),i.querySelector(".js-img").classList.remove("is-hidden"))}let d=i.querySelector(".js-btn-buy"),l=i.querySelector(".js-btn-cancel-offer");return e.value.seller===h?(d.classList.add("is-hidden"),l.classList.remove("is-hidden"),l.addEventListener("click",(()=>async function(e){let t=event.currentTarget,r=event.target.closest(".js-listing");t.classList.add("is-loading");let i=await async function(e){try{let t=await T.requestOperation({operationDetails:[{kind:beacon.TezosOperationType.TRANSACTION,amount:0,destination:p,parameters:{entrypoint:"cancel_offer",value:JSON.parse('{ "int": "'+e+'" }')}}]});if(t.transactionHash)return t.transactionHash}catch(e){console.log("ERROR "+n()+"(): "+e+" "+JSON.stringify(e))}}(e);i&&(te(i),r.remove()),t.classList.remove("is-loading")}(e.key)))):(l.classList.add("is-hidden"),d.classList.remove("is-hidden"),d.addEventListener("click",(()=>X(e.key,e.value.price)))),i.querySelectorAll(".js-token-item").forEach((function(e){e.setAttribute("href",window.location.pathname+"?cmd=token&cid="+a.contract.address+"&tid="+a.tokenId)})),i}async function x(){let t,r=new Map;if(t=document.getElementById("cName").value.trim(),t)if(t.length>200)bulmaToast.toast({message:"The name length must be less than 200 characters.",type:"is-danger"});else{if(r.set("name",t),t=document.getElementById("cDescription").value.trim(),t){if(t.length>2e3)return void bulmaToast.toast({message:"The description length must be less than 2000 characters.",type:"is-danger"});r.set("description",t)}if(t=document.getElementById("cSymbol").value.trim(),t&&r.set("symbol",t),t=document.getElementById("cType").value.trim(),t&&r.set("type",t),t=document.getElementById("cInterfaces").value.split(/\s*,\s*/).filter((e=>e.length>0)),t.length>0&&r.set("interfaces",t),t=document.getElementById("cAuthors").value.split(/\s*,\s*/).filter((e=>e.length>0)),t.length>0&&r.set("authors",t),t=document.getElementById("cAddresses").value.split(/\s*,\s*/).filter((e=>e.length>0)),t.length>0){for(let e of t)if(!a(e))return void bulmaToast.toast({message:"Invalid author address: "+e,type:"is-danger"});t.sort(),r.set("authoraddress",t)}if(t=document.getElementById("cCreators").value.split(/\s*,\s*/).filter((e=>e.length>0)),t.length>0){for(let e of t)if(!a(e))return void bulmaToast.toast({message:"Invalid creator address: "+e,type:"is-danger"});t.sort(),r.set("creators",t)}if(t=document.getElementById("cFileImage").getAttribute("src"),t&&r.set("imageUri",t),j){document.getElementById("btnCollectionDataSave").classList.add("is-loading");let t=await async function(t,r){let i=r.size>0?e(JSON.stringify(Object.fromEntries(r))):"";try{let e=await T.requestOperation({operationDetails:[{kind:beacon.TezosOperationType.TRANSACTION,amount:0,destination:t,parameters:{entrypoint:"update_contract_metadata",value:JSON.parse('{"bytes":"'+i+'"}')}}]});if(e.transactionHash)return e.transactionHash;console.log("ERROR "+n()+"(): can't edit collection")}catch(e){console.log("ERROR "+n()+"(): "+e+JSON.stringify(e))}}(j,r);t&&te(t),document.getElementById("btnCollectionDataSave").classList.remove("is-loading")}else{document.getElementById("btnCollectionDataCreate").classList.add("is-loading");let t=await async function(t){let r=t.size>0?e(JSON.stringify(Object.fromEntries(t))):"";try{let e;if(E)e=E;else{let t=await fetch("./user_collection.json");t.ok&&(e=await t.text())}if(e){e=e.replaceAll("${user_address}",h),e=e.replaceAll("${metadata_content}",r);const t=await T.requestOperation({operationDetails:[{kind:beacon.TezosOperationType.ORIGINATION,balance:"0",script:JSON.parse(e)}]});if(t.transactionHash)return t.transactionHash}else console.log("ERROR "+n()+"(): can't create collection")}catch(e){console.log("ERROR "+n()+"(): "+e+JSON.stringify(e))}}(r);t&&te(t),document.getElementById("btnCollectionDataCreate").classList.remove("is-loading")}}else bulmaToast.toast({message:"The collection name must not be empty.",type:"is-danger"})}function z(){document.getElementById("cFile").value="",document.getElementById("cFileSizeIcon").classList.add("is-hidden"),document.getElementById("cFileSize").innerHTML="&nbsp;",document.getElementById("cFileName").innerHTML="Choose a file ...",document.getElementById("cFileImage").classList.add("is-hidden"),document.getElementById("cFileImage").setAttribute("src","")}async function J(){let e,t=new Map,r=document.getElementById("nftCollection").value;if(!r)return void bulmaToast.toast({message:"Collection must be selected.",type:"is-danger"});if(e=document.getElementById("nftName").value.trim(),e){if(e.length>200)return void bulmaToast.toast({message:"The name length must be less than 200 characters.",type:"is-danger"});t.set("name",e)}if(e=document.getElementById("nftDescription").value.trim(),e){if(e.length>200)return void bulmaToast.toast({message:"The description length must be less than 2000 characters.",type:"is-danger"});t.set("description",e)}if(e=document.getElementById("nftTags").value.trim().split(/\s*,\s*/).filter((e=>e.length>0)),e.length>0){for(let t of e)if(t.length<3)return void bulmaToast.toast({message:"The tag length must be more than 2 characters.",type:"is-danger"});e.sort(((e,t)=>e.localeCompare(t))),t.set("tags",e)}if(e=document.getElementById("nftCreators").value.trim().split(/\s*,\s*/).filter((e=>e.length>0)),e.length>0){for(let t of e)if(!a(t))return void bulmaToast.toast({message:"Invalid creator address: "+t,type:"is-danger"});e.sort(),t.set("creators",e)}e=document.getElementById("nftRights").value.trim(),e&&t.set("rights",e),e=document.getElementById("nftDecimals").value.trim(),e&&t.set("decimals",e),e=document.getElementById("nftType").value.trim(),e&&t.set("mimeType",e);let i=new Map,s=0,n=document.getElementById("pageTokenData").querySelectorAll(".js-royalties-line-data");for(let e of n){let t=e.querySelector(".js-royalties-data-address").value.trim();if(0===t.length)return void bulmaToast.toast({message:"The royalty address must not be empty.",type:"is-danger"});if(!a(t))return void bulmaToast.toast({message:"Invalid royalty address: "+t,type:"is-danger"});if(i.has(t))return void bulmaToast.toast({message:"The royalty addresses must be different.",type:"is-danger"});let r=e.querySelector(".js-royalties-data-value").value;try{r=Math.round(100*parseFloat(r))}catch(e){return void bulmaToast.toast({message:"The royalty value must be a number.",type:"is-danger"})}if(r<=0)return void bulmaToast.toast({message:"The royalty value must be greater than zero.",type:"is-danger"});if(s+=r,s>2500)return void bulmaToast.toast({message:"The maximum amount of the total royalty shall not exceed 25%.",type:"is-danger"});i.set(t,r)}i.size>0&&(e='{"decimals":4,"shares":'+JSON.stringify(Object.fromEntries(i))+"}",t.set("royalties",e));let o=new Map,m=document.getElementById("pageTokenData").querySelectorAll(".js-attributes-line-data");for(let e of m){let t=e.querySelector(".js-attributes-data-name").value.trim();if(0===t.length)return void bulmaToast.toast({message:"The attribute name must not be empty.",type:"is-danger"});if(o.has(t))return void bulmaToast.toast({message:"The attribute names must be different.",type:"is-danger"});let r=e.querySelector(".js-attributes-data-value").value;o.set(t,r)}if(o.size>0){let e="[",r=!0;for(let[t,i]of o)r?r=!1:e+=",",e+='{"name":"'+t+'","value":"'+i+'"}';e+="]",t.set("attributes",e)}const d=document.getElementById("nftFile").files;if(e=d.length>0?await new Promise((e=>{let t=new FileReader;t.onload=r=>e(t.result),t.readAsDataURL(d[0])})):function(){const e=document.getElementById("nftPreviewContainer");let t=e.querySelector(".js-svg");if(t&&!t.classList.contains("is-hidden"))return t.getAttribute("data");for(let r of[".js-img",".js-text",".js-data",".js-audio",".js-video"])if(t=e.querySelector(r),t&&!t.classList.contains("is-hidden"))return t.getAttribute("src")}(),!e)return void bulmaToast.toast({message:"Media file must be selected.",type:"is-danger"});t.set("artifactUri",e);let l=document.getElementById("nftEditions").value;if(j&&q&&B&&B.metadata){let e=new Set;for(let r in B.metadata)t.has(r)||e.add(r);for(let[e,r]of t)if(B.metadata.hasOwnProperty(e)){let i=r,a=B.metadata[e];try{"string"==typeof i||i instanceof String||(i=JSON.stringify(i)),"string"==typeof a||a instanceof String||(a=JSON.stringify(a)),i===a&&t.delete(e)}catch(e){}}for(let r of e)t.set(r,"");if(0===t.size)return void bulmaToast.toast({message:"There is no new data to update NFT.",type:"is-warning"})}if(t.has("artifactUri")&&t.get("artifactUri").length>f){let e=document.getElementById("nftCollection");e.options[e.selectedIndex].text.startsWith("(*) ")?(C={state:-1,collectionAddress:r,editions:l,metadata:t},setTimeout(Q,10)):bulmaToast.toast({message:"This collection does not support big media files.<br/>Create a new one or choose a collection that does.",duration:7e3,type:"is-danger"})}else if(j&&q){document.getElementById("btnTokenDataSave").classList.add("is-loading");let e=await D(j,q,t);e&&te(e),document.getElementById("btnTokenDataSave").classList.remove("is-loading")}else{document.getElementById("btnTokenDataCreate").classList.add("is-loading");let e=await L(r,l,t);e&&te(e),document.getElementById("btnTokenDataCreate").classList.remove("is-loading")}}async function Q(){const t=document.getElementById("mCreateToken"),r=document.getElementById("mCreateTokenInfo"),i=document.getElementById("prCreateTokenProgress");let a;if(j&&q){a=document.getElementById("btnCreateTokenUpdate");for(let e of t.querySelectorAll(".js-mode-create"))e.classList.add("is-hidden")}else{a=document.getElementById("btnCreateTokenCreate");for(let e of t.querySelectorAll(".js-mode-edit"))e.classList.add("is-hidden")}switch(C.state){case-1:i.value=0,a.removeAttribute("disabled"),a.classList.remove("is-loading"),r.textContent="",document.getElementById("mCreateToken").classList.add("is-active"),C.state=0;break;case 0:a.classList.add("is-loading"),r.textContent="Uploading token metadata...";let t,s=C.metadata.get("artifactUri");if(s.startsWith("data:")?(C.metadata.set("artifactUri","data:"),s=s.substring(5)):C.metadata.set("artifactUri",""),t=j&&q?await D(C.collectionAddress,q,C.metadata):await L(C.collectionAddress,C.editions,C.metadata),t){delete C.metadata,delete C.editions,C.txHash=t;let e=[];for(let t=0;t<s.length;t+=f)e.push(s.slice(t,t+f));C.part=-1,C.parts=Math.ceil(s.length/f),C.uploads=e,C.state=1,setTimeout(Q,3e3)}else C.metadata.set("artifactUri",s),a.classList.remove("is-loading"),r.textContent=j&&q?"The updating is stopped. Press UPDATE to continue...":"The minting is stopped. Press MINT to continue...";break;case 1:let o;if(C.part<0)if(j&&q)await k(C.txHash)?(i.value=100/(C.parts+1),delete C.txHash,C.tokenId=q,C.state=2,o=10):o=3e3;else{let e=await async function(e){try{let t=await fetch("https://api."+l+".tzkt.io/v1/operations/transactions/"+e);if(t.ok){const e=await t.json();if(e&&e.length>0){let t=null;for(let r of e[0].diffs)if("ledger"===r.path&&"add_key"===r.action){t=r.content.key.nat;break}return{status:e[0].status,tokenId:t}}}else console.log("ERROR "+n()+"(): can't get new tokenId for "+e)}catch(e){console.log("ERRROR "+n()+"(): "+e+" "+JSON.stringify(e))}return null}(C.txHash);e&&"applied"===e.status?(i.value=100/(C.parts+1),delete C.txHash,C.tokenId=e.tokenId,C.state=2,o=10):o=3e3}else await k(C.txHash)?(i.value=100/(C.parts+1)*(C.part+2),delete C.txHash,C.state=2,o=10):o=3e3;setTimeout(Q,o);break;case 2:if(C.part++,C.part<C.parts){a.classList.add("is-loading"),r.textContent="Uploading media resource part "+(C.part+1)+"/"+C.parts+"...";let t=await async function(t,r,i,a){try{let i=await T.requestOperation({operationDetails:[{kind:beacon.TezosOperationType.TRANSACTION,amount:0,destination:t,parameters:{entrypoint:"append_token_metadata",value:JSON.parse('{"prim": "Pair","args":[{"string":"artifactUri"},{"prim":"Pair","args":[{"int":"'+r+'"},{"bytes":"'+e(a)+'"}]}]}')}}]});if(i.transactionHash)return i.transactionHash}catch(e){console.log("ERROR "+n()+"(): "+e+" "+JSON.stringify(e))}}(C.collectionAddress,C.tokenId,0,C.uploads[C.part]);t?(C.txHash=t,C.state=1,setTimeout(Q,3e3)):(C.part--,a.classList.remove("is-loading"),r.textContent="The minting is stopped. Press MINT to continue...",r.textContent=j&&q?"The updating is stopped. Press UPDATE to continue...":"The minting is stopped. Press MINT to continue...")}else r.textContent=j&&q?"The NFT has been updated.":"The NFT has been minted.",a.setAttribute("disabled",""),a.classList.remove("is-loading"),C.state=3,setTimeout(Q,2500);break;case 3:document.getElementById("mCreateToken").classList.remove("is-active"),j&&q?bulmaToast.toast({message:"The NFT has been updated.",type:"is-success"}):bulmaToast.toast({message:"The NFT has been minted.",type:"is-success"});break;default:a.classList.remove("is-loading")}}function K(e,t){const r=document.getElementById("nftPreviewContainer");if(t||(t=ee(e)),t)if(r.querySelector(".js-img").classList.add("is-hidden"),t.startsWith("image"))if(t.startsWith("image/svg+xml")){let t=r.querySelector(".js-svg-template").cloneNode(!0);t.classList.remove("js-svg-template"),t.classList.add("js-svg"),t.setAttribute("data",e),r.append(t),t.classList.remove("is-hidden")}else r.querySelector(".js-img").setAttribute("src",e),r.querySelector(".js-img").classList.remove("is-hidden");else t.startsWith("audio")?(r.querySelector(".js-audio").setAttribute("src",e),r.querySelector(".js-audio").classList.remove("is-hidden")):t.startsWith("video")?(r.querySelector(".js-video").setAttribute("src",e),r.querySelector(".js-video").classList.remove("is-hidden")):t.startsWith("text")?(r.querySelector(".js-text").setAttribute("src",e),r.querySelector(".js-text").classList.remove("is-hidden")):(r.querySelector(".js-data").setAttribute("src",e),r.querySelector(".js-data").classList.remove("is-hidden"));else r.querySelector(".js-img").setAttribute("src",e)}function $(){document.getElementById("nftType").value="",document.getElementById("nftFileName").innerHTML="Choose a file ...",document.getElementById("nftFileSizeIcon").classList.add("is-hidden"),document.getElementById("nftFileSize").innerHTML="&nbsp;";const e=document.getElementById("nftPreviewContainer");let t=e.querySelector(".js-svg");t&&t.remove();for(let r of[".js-img",".js-text",".js-data",".js-audio",".js-video"])t=e.querySelector(r),t.classList.contains("is-hidden")||(t.classList.add("is-hidden"),t.setAttribute("src",""))}async function X(e,t){let r=event.currentTarget;r.classList.add("is-loading");let i=await async function(e,t,r){try{let t=await T.requestOperation({operationDetails:[{kind:beacon.TezosOperationType.TRANSACTION,amount:1*r,destination:p,parameters:{entrypoint:"accept_offer",value:JSON.parse('{"prim":"Pair","args":[{"int":"1"},{"int":"'+e+'"}]}')}}]});if(t.transactionHash)return t.transactionHash}catch(e){console.log("ERROR "+n()+"(): "+e+" "+JSON.stringify(e))}}(e,0,t);i&&te(i),r.classList.remove("is-loading")}function Z(){let e=event.currentTarget.querySelector(".fas");event.currentTarget.parentElement.querySelector(".is-collapsible").classList.toggle("is-active"),e.classList.toggle("fa-angle-down"),e.classList.toggle("fa-angle-up")}async function V(e){let t=h;await async function(e){let t=await T.getActiveAccount();if(t)h=t.address;else if(!e){let e=await T.requestPermissions();h=e.address}}(e),h&&(document.getElementById("divConnect").classList.add("is-hidden"),document.getElementById("aAddress").innerHTML=r(h),document.getElementById("divDisconnect").classList.remove("is-hidden")),e||t===h||window.location.reload()}function Y(){document.querySelectorAll(".js-page").forEach((function(e){e.classList.add("is-hidden")}))}function ee(e){return e&&e.startsWith("data:")?e.startsWith("data:image/svg+xml")?"image/svg+xml":e.startsWith("data:image")?"image":e.startsWith("data:text")?"text":e.startsWith("data:audio")?"audio":e.startsWith("data:video")?"video":"data":""}function te(e){bulmaToast.toast({message:"Your request is processing with ID <a href='https://"+l+".tzkt.io/"+e+"' target='_blank'>"+r(e)+"</a>",duration:5e3,type:"is-success"})}function re(){bulmaToast.toast({message:"The data cannot be retrieved at this moment.<br/>Please try again later.",duration:7e3,type:"is-warning"})}document.addEventListener("DOMContentLoaded",(async function(){document.getElementById("appTitle").prepend(document.createTextNode(I)),document.getElementById("appLogo").setAttribute("alt",I),document.getElementById("appVersion").append(document.createTextNode("v1.1")),m&&document.getElementById("btnMenuConfig").classList.add("is-hidden"),"mainnet"===l?(document.getElementById("iconMainnetNotActive").classList.add("is-hidden"),document.getElementById("iconMainnetActive").classList.remove("is-hidden"),document.getElementById("iconTestnetActive").classList.add("is-hidden"),document.getElementById("iconTestnetNotActive").classList.remove("is-hidden")):(document.getElementById("titleNetwork").innerHTML="&nbsp;testnet",document.getElementById("titleNetwork").classList.remove("is-hidden"),document.getElementById("iconMainnetActive").classList.add("is-hidden"),document.getElementById("iconMainnetNotActive").classList.remove("is-hidden"),document.getElementById("iconTestnetNotActive").classList.add("is-hidden"),document.getElementById("iconTestnetActive").classList.remove("is-hidden")),bulmaToast.setDefaults({duration:5e3,position:"bottom-left",animate:{in:"zoomIn",out:"zoomOut"}}),T=new beacon.DAppClient({name:I,network:{type:l,rpcUrl:"https://rpc.tzkt.io/"+l}}),T.subscribeToEvent(beacon.BeaconEvent.ACTIVE_ACCOUNT_SET,(e=>{})),await V(!0);let e=new URLSearchParams(window.location.search).get("cmd");"tokens"===e?await async function(){Y(),document.getElementById("dTokens").innerHTML="",document.getElementById("pageTokens").classList.remove("is-hidden");let e=new URLSearchParams(window.location.search).get("cid");if(e){j=e,N=await A(e),h&&N&&y(N.typeHash)&&(h===N.creator.address?(0!==N.tokensCount&&document.getElementById("btnEditCollection").setAttribute("disabled",""),document.getElementById("btnNewTokenCollection").classList.remove("is-hidden"),document.getElementById("pageTokensCollectionButtons").classList.remove("is-hidden")):Array.isArray(N.storage?.collaborators)&&N.storage?.collaborators.includes(h)&&(document.getElementById("btnCollabs").classList.add("is-hidden"),document.getElementById("btnEditCollection").classList.add("is-hidden"),document.getElementById("btnNewTokenCollection").classList.remove("is-hidden"),document.getElementById("pageTokensCollectionButtons").classList.remove("is-hidden")));let a=await S(e),s=document.getElementById("pageTokensCollection");if(a)try{a=JSON.parse(t(a));let n=a.imageUri;if(n){try{new URL(n),n=n.replace("ipfs://","https://ipfs.io/ipfs/")}catch(e){}s.querySelector(".js-img").setAttribute("src",n)}s.querySelector(".js-name").innerText=a.name?a.name:"",s.querySelector(".js-description").innerText=a.description?a.description:"",s.querySelector(".js-address").prepend(document.createTextNode(r(e))),s.querySelector(".copy-item").addEventListener("click",(()=>{i(e)&&bulmaToast.toast(U)})),s.classList.remove("is-hidden")}catch(e){}else s.classList.add("is-hidden")}await H()}():"token"===e?await async function(){Y();let e=document.getElementById("btnTokenEdit");e.classList.add("is-hidden"),e.setAttribute("disabled","");let t=document.getElementById("btnTokenList");t.classList.add("is-hidden");let a=document.getElementById("btnTokenBurn");a.classList.add("is-hidden");let s=document.getElementById("btnTokenTransfer");s.classList.add("is-hidden");let n=document.getElementById("btnTokenBuy");document.getElementById("dToken").classList.add("is-hidden"),document.getElementById("pageToken").classList.remove("is-hidden");let o=new URLSearchParams(window.location.search),m=o.get("cid"),d=o.get("tid");m&&(j=m),d&&(q=d);let l,c=document.getElementById("pageToken"),p=await R(j,q);if(p){let o;if(B=p,p.account===h&&p.balance>0&&(t.classList.remove("is-hidden"),a.classList.remove("is-hidden"),s.classList.remove("is-hidden"),new Promise((t=>{setTimeout((()=>{t(Promise.all([b({contract:j,tokenId:q}),e]))}),10)})).then((t=>{t[0]&&t[0].length>0&&h===t[0][0].firstMinter?.address&&(t[1].addEventListener("click",(()=>{window.location.search="cmd=tokendata&cid="+j+"&tid="+q})),t[1].classList.remove("is-hidden"),p.balance===p.token.totalSupply&&e.removeAttribute("disabled"))}))),new Promise((e=>{setTimeout((()=>{e(Promise.all([P(p.token.contract.address,p.token.tokenId),n]))}),10)})).then((e=>{e[0]&&(e[1].append(document.createTextNode((parseFloat(e[0].value.price)/1e6).toFixed(2)+" ꜩ")),e[1].addEventListener("click",(()=>X(e[0].key,e[0].value.price))),e[1].removeAttribute("disabled"))})),l=p.token.metadata?.name,c.querySelector(".js-name").innerText=l||"",l=p.token.metadata?.description,c.querySelector(".js-description").innerText=l||"",l=p.token.metadata?.creators,!Array.isArray(l))try{l=JSON.parse(l)}catch(e){}let m=c.querySelector(".js-creators");if(Array.isArray(l)&&l.length>0){let e=c.querySelector(".js-creator");for(let t=0;t<l.length;t++){let i=l[t];o=e.cloneNode(!0),o.setAttribute("href",window.location.pathname+"?cmd=tokens&creator="+i),o.append(document.createTextNode(r(i))),o.classList.remove("is-hidden"),m.append(o),m.append(document.createElement("br"))}}else m.innerText="";l=h&&h===p.account?p.balance:"",c.querySelector(".js-balance").innerText=l||"",l=p.token.totalSupply,c.querySelector(".js-editions").innerText=l||"",l=p.firstTime,c.querySelector(".js-firsttime").innerText=l?new Date(Date.parse(l)).toLocaleString():"";let d=p.token.contract.address;o=c.querySelector(".js-contract"),o.setAttribute("href",window.location.pathname+"?cmd=tokens&cid="+d),o.append(document.createTextNode(r(d))),c.querySelector(".js-contract-copy").addEventListener("click",(()=>{d&&i(d)&&bulmaToast.toast(U)})),l=p.token.tokenId,c.querySelector(".js-tokenid").innerText=l||"";let g=c.querySelector(".tags"),u=g.querySelector(".tag");l=p.token.metadata?.tags;try{l=JSON.parse(l);for(let e=0;e<l.length;e++)o=u.cloneNode(!0),o.append(document.createTextNode(l[e])),o.setAttribute("href",window.location.pathname+"?cmd=tokens&tag="+l[e]),o.classList.remove("is-hidden"),g.append(o)}catch(e){g.innerText=""}let y=p.token.metadata?.mimeType;if(c.querySelector(".js-type").innerText=y||"",l=p.token.metadata?.displayUri?p.token.metadata?.displayUri:p.token.metadata?.thumbnailUri?p.token.metadata?.thumbnailUri:p.token.metadata?.artifactUri,l){try{new URL(l),l=l.replace("ipfs://","https://ipfs.io/ipfs/")}catch(e){}y=ee(l),y||(y=p.token.metadata?.mimeType),y?y.startsWith("image")?(c.querySelector(".js-container-audio").remove(),c.querySelector(".js-container-video").remove(),c.querySelector(".js-container-text").remove(),c.querySelector(".js-container-data").remove(),y.startsWith("image/svg+xml")?(c.querySelector(".js-img").remove(),c.querySelector(".js-svg").setAttribute("data",l)):(c.querySelector(".js-svg").remove(),c.querySelector(".js-img").setAttribute("src",l)),c.querySelector(".js-container-img").classList.remove("is-hidden")):y.startsWith("audio")?(c.querySelector(".js-container-img").remove(),c.querySelector(".js-container-video").remove(),c.querySelector(".js-container-text").remove(),c.querySelector(".js-container-data").remove(),c.querySelector(".js-audio").setAttribute("src",l),c.querySelector(".js-container-audio").classList.remove("is-hidden")):y.startsWith("video")?(c.querySelector(".js-container-img").remove(),c.querySelector(".js-container-audio").remove(),c.querySelector(".js-container-text").remove(),c.querySelector(".js-container-data").remove(),c.querySelector(".js-video").setAttribute("src",l),c.querySelector(".js-container-video").classList.remove("is-hidden")):y.startsWith("text")?(c.querySelector(".js-container-audio").remove(),c.querySelector(".js-container-video").remove(),c.querySelector(".js-container-img").remove(),c.querySelector(".js-container-data").remove(),c.querySelector(".js-container-text").classList.remove("is-hidden")):(c.querySelector(".js-container-audio").remove(),c.querySelector(".js-container-video").remove(),c.querySelector(".js-container-img").remove(),c.querySelector(".js-container-text").remove(),c.querySelector(".js-container-data").classList.remove("is-hidden")):(c.querySelector(".js-container-audio").remove(),c.querySelector(".js-container-video").remove(),c.querySelector(".js-container-text").remove(),c.querySelector(".js-container-data").remove(),c.querySelector(".js-svg").remove(),c.querySelector(".js-img").setAttribute("src",l),c.querySelector(".js-container-img").classList.remove("is-hidden"))}document.getElementById("dToken").classList.remove("is-hidden")}}():"tokendata"===e||"newtoken"===e?await async function(){Y(),h?document.getElementById("nftCreators").value=h:(document.getElementById("pageTokenDataForm").setAttribute("disabled",""),bulmaToast.toast({message:"To mint or update token you need to connect wallet.",type:"is-danger"}));const e=document.getElementById("pageTokenData"),r=document.getElementById("nftCollection");let i=new URLSearchParams(window.location.search);if(j=i.get("cid"),q=i.get("tid"),j&&q){document.getElementById("nftEditions").setAttribute("disabled","");for(let t of e.querySelectorAll(".js-mode-create"))t.classList.add("is-hidden");let t=await b({contract:j,tokenId:q});if(t&&t.length>0){t=t[0],B=t,h===t.firstMinter.address?document.getElementById("btnTokenDataSave").removeAttribute("disabled"):document.getElementById("pageTokenDataForm").setAttribute("disabled",""),document.getElementById("nftName").value=t.metadata.name?t.metadata.name:"",document.getElementById("nftDescription").value=t.metadata.description?t.metadata.description:"";let e="";if(t.metadata.tags)if(Array.isArray(t.metadata.tags))e=t.metadata.tags.join();else try{e=JSON.parse(t.metadata.tags)}catch(e){}if(document.getElementById("nftTags").value=e,e="",t.metadata.creators)if(Array.isArray(t.metadata.creators))e=t.metadata.creators.join();else try{e=JSON.parse(t.metadata.creators)}catch(e){}if(document.getElementById("nftCreators").value=e,document.getElementById("nftType").value=t.metadata.mimeType?t.metadata.mimeType:"",document.getElementById("nftRights").value=t.metadata.rights?t.metadata.rights:"",document.getElementById("nftDecimals").value=t.metadata.decimals?t.metadata.decimals:"",document.getElementById("nftEditions").value=t.totalSupply?t.totalSupply:"",t.metadata.royalties)try{let e=JSON.parse(t.metadata.royalties);const r=document.getElementById("pageTokenData").querySelector(".js-royalties-line-template");if(e.shares&&e.decimals){let t=parseInt(e.decimals);for(var a in e.shares)if(e.shares.hasOwnProperty(a)){let i=r.cloneNode(!0);i.classList.remove("is-hidden"),i.classList.remove("js-royalties-line-template"),i.querySelector(".js-royalties-data-address").value=a,i.querySelector(".js-royalties-data-value").value=Number(e.shares[a])/10**(t-2),i.classList.add("js-royalties-line-data"),r.before(i)}}}catch(e){}if(t.metadata.attributes)try{let e=JSON.parse(t.metadata.attributes);const r=document.getElementById("pageTokenData").querySelector(".js-attributes-line-template");for(let t of e){let e=r.cloneNode(!0);e.classList.remove("is-hidden"),e.classList.remove("js-attributes-line-template"),e.classList.add("js-attributes-line-data"),e.querySelector(".js-attributes-data-name").value=t.name,e.querySelector(".js-attributes-data-value").value=t.value,r.before(e)}}catch(e){}t.metadata.artifactUri&&K(t.metadata.artifactUri,null)}else bulmaToast.toast({message:"The token is not loaded.",type:"is-danger"})}else for(let t of e.querySelectorAll(".js-mode-edit"))t.classList.add("is-hidden");e.classList.remove("is-hidden"),r.parentNode.classList.add("is-loading");let s=new Option("(*) - ZeroTerminal collection -",c);r.append(s);let n=[];if(j)if(r.setAttribute("disabled",""),j===c)s.selected=!0;else{let e=await A(j);e&&n.push(e)}else h&&(n=await v({creator:h,limit:15,offset:O}));for(let e of n){let i=await S(e.address);if(i)try{i=JSON.parse(t(i))}catch(e){continue}let a=new Option((y(e.typeHash)?"(*) ":"")+i?.name,e.address);r.append(a),j===e.address&&(a.selected=!0,y(e.typeHash)||document.getElementById("btnTokenDataSave").setAttribute("disabled",""))}r.parentNode.classList.remove("is-loading")}():"collections"===e?await async function(){Y(),document.getElementById("dCollections").innerHTML="",document.getElementById("pageCollections").classList.remove("is-hidden"),await M()}():"collectiondata"===e||"newcollection"===e?await async function(){Y(),h?(document.getElementById("btnCollectionDataCreate").removeAttribute("disabled"),document.getElementById("btnCollectionDataSave").removeAttribute("disabled"),document.getElementById("cCreators").value=h):(document.getElementById("btnCollectionDataCreate").setAttribute("disabled",""),document.getElementById("btnCollectionDataSave").setAttribute("disabled",""),bulmaToast.toast({message:"To create a new collection you need to connect wallet.",type:"is-danger"}));const e=document.getElementById("pageCollectionData");let r=new URLSearchParams(window.location.search);if(j=r.get("cid")){let r=e.querySelectorAll(".js-mode-create");for(let e of r)e.classList.add("is-hidden");let i=await S(j);if(i)try{i=JSON.parse(t(i)),document.getElementById("cName").value=i.name?i.name:"",document.getElementById("cDescription").value=i.description?i.description:"",document.getElementById("cType").value=i.type?i.type:"",document.getElementById("cAuthors").value=i.authors?i.authors.join():"",document.getElementById("cAddresses").value=i.authoraddress?i.authoraddress.join():"",document.getElementById("cCreators").value=i.creators?i.creators.join():"",document.getElementById("cInterfaces").value=i.interfaces?i.interfaces.join():"",i.imageUri&&(document.getElementById("cFileImage").classList.remove("is-hidden"),document.getElementById("cFileImage").setAttribute("src",i.imageUri))}catch(e){bulmaToast.toast({message:"Collection info can't be parsed.",type:"is-danger"})}}else{let t=e.querySelectorAll(".js-mode-edit");for(let e of t)e.classList.add("is-hidden")}e.classList.remove("is-hidden")}():"listings"===e?await async function(){Y(),document.getElementById("dListings").innerHTML="",document.getElementById("pageListings").classList.remove("is-hidden"),await W()}():"search"===e?await async function(){Y(),document.getElementById("pageSearch").classList.remove("is-hidden")}():"info"===e?await(document.getElementById("btnBurger").classList.remove("is-active"),document.getElementById("navbarMenu").classList.remove("is-active"),Y(),void document.getElementById("pageInfo").classList.remove("is-hidden")):await async function(){Y(),document.getElementById("dActiveTokens").innerHTML="",document.getElementById("pageActiveTokens").classList.remove("is-hidden"),await F()}()})),document.getElementById("dMoreActiveTokens").addEventListener("click",(()=>F())),document.getElementById("btnMoreCollections").addEventListener("click",(()=>M())),document.getElementById("btnEditCollection").addEventListener("click",(()=>{window.location.search="cmd=collectiondata&cid="+j})),document.getElementById("btnNewTokenCollection").addEventListener("click",(()=>{window.location.search="cmd=tokendata&cid="+j})),document.getElementById("btnCollabs").addEventListener("click",(()=>function(){if(document.getElementById("btnCollabSave").classList.remove("is-loading"),document.getElementById("fieldCollabAddress").value="",document.getElementById("mCollab").classList.add("is-active"),N){let e=document.getElementById("mCollabCollaborators");e.options.length=0;let t=N.storage?.collaborators;if(t)for(let r of t)e.append(new Option(r,r))}}())),document.getElementById("btnCollabAdd").addEventListener("click",(()=>function(){let e=document.getElementById("fieldCollabAddress").value.trim();a(e)?(document.getElementById("mCollabCollaborators").append(new Option(e,e)),document.getElementById("fieldCollabAddress").value=""):bulmaToast.toast({message:"Invalid collaborator address: "+e,type:"is-danger"})}())),document.getElementById("btnCollabRemove").addEventListener("click",(()=>function(){let e=document.getElementById("mCollabCollaborators");e.selectedIndex>=0&&e.options[e.selectedIndex].remove()}())),document.getElementById("btnCollabShare").addEventListener("click",(()=>{i(window.location.origin+window.location.pathname+"?cmd=tokendata&cid="+j)&&bulmaToast.toast({message:"Link to collaboration copied.",type:"is-success"})})),document.getElementById("btnCollabSave").addEventListener("click",(()=>async function(){document.getElementById("btnCollabSave").classList.add("is-loading");let e=new Set(N.storage?.collaborators),t=new Set([...document.getElementById("mCollabCollaborators").options].map((e=>e.value))),r=[];for(let i of e.values())t.has(i)&&(e.delete(i),t.delete(i),r.push(i));if(await async function(e,t,r){let i=[],a=[];if(t&&t.size>0){t=Array.from(t).sort(((e,t)=>s(e,t)));for(let e of t)i.push('{"string":"'+e+'"}');a.push({kind:beacon.TezosOperationType.TRANSACTION,amount:0,destination:e,parameters:{entrypoint:"remove_collaborators",value:JSON.parse("["+i.join()+"]")}})}if(r&&r.size>0){i.length=0,r=Array.from(r).sort(((e,t)=>s(e,t)));for(let e of r)i.push('{"string":"'+e+'"}');a.push({kind:beacon.TezosOperationType.TRANSACTION,amount:0,destination:e,parameters:{entrypoint:"add_collaborators",value:JSON.parse("["+i.join()+"]")}})}if(!(a.length>0))return!0;try{let e=await T.requestOperation({operationDetails:a});if(e.transactionHash)return e.transactionHash}catch(e){console.log("ERROR "+n()+"(): "+e+" "+JSON.stringify(e))}}(j,e,t)){if(N.storage?.collaborators){for(let e of t.values())r.push(e);N.storage.collaborators=r}document.getElementById("mCollab").classList.remove("is-active")}document.getElementById("btnCollabSave").classList.remove("is-loading")}())),document.getElementById("btnMoreTokens").addEventListener("click",(()=>H())),document.getElementById("btnMoreListings").addEventListener("click",(()=>W())),document.getElementById("btnSearch").addEventListener("click",(()=>async function(){let e="";if(document.getElementById("searchListTab").classList.contains("is-active")){let t,r,i=document.getElementById("searchListMinPrice").value;if(i){if(i=Math.round(parseFloat(i)*10**6),Number.isNaN(i)||i<=0)return void bulmaToast.toast({message:"Invalid min price.",type:"is-danger"});t=i,e+="&minprice="+i}if(i=document.getElementById("searchListMaxPrice").value,i){if(i=Math.round(parseFloat(i)*10**6),Number.isNaN(i)||i<=0)return void bulmaToast.toast({message:"Invalid max price.",type:"is-danger"});r=i,e+="&maxprice="+i}if(t&&r&&t>r)return void bulmaToast.toast({message:"Invalid price range.",type:"is-danger"});if(i=document.getElementById("searchListAddress").value.trim(),i){if(!a(i))return void bulmaToast.toast({message:"Invalid token or collection address.",type:"is-danger"});e+="&cid="+i}if(i=document.getElementById("searchListSeller").value.trim(),i){if(!a(i))return void bulmaToast.toast({message:"Invalid seller address.",type:"is-danger"});e+="&seller="+i}window.location.search="cmd=listings"+e}else if(document.getElementById("searchColTab").classList.contains("is-active")){let t=document.getElementById("searchColAddress").value.trim();if(t){if(!a(t))return void bulmaToast.toast({message:"Invalid collection address.",type:"is-danger"});e+="&cid="+t}if(t=document.getElementById("searchColCreator").value.trim(),t){if(!a(t))return void bulmaToast.toast({message:"Invalid creator address.",type:"is-danger"});e+="&creator="+t}window.location.search="cmd=collections"+e}else if(document.getElementById("searchTokTab").classList.contains("is-active")){let t=document.getElementById("searchTokName").value.trim();if(t){if(t.length>200)return void bulmaToast.toast({message:"The name length must be less than 200 characters.",type:"is-danger"});e+="&name="+encodeURIComponent(t)}t=document.getElementById("searchTokCreators").value.trim().split(/\s*,\s*/).filter((e=>e.length>0));for(let r of t){if(!a(r))return void bulmaToast.toast({message:"Invalid creator address: "+r,type:"is-danger"});e+="&creator="+r.trim()}t=document.getElementById("searchTokTags").value.trim().split(/\s*,\s*/).filter((e=>e.length>0));for(let r of t){if(r.length<3)return void bulmaToast.toast({message:"The tag length must be more than 2 characters.",type:"is-danger"});e+="&tag="+encodeURIComponent(r.trim())}if(t=document.getElementById("searchTokType").value.trim(),t&&(e+="&type="+t),t=document.getElementById("searchTokMinter").value.trim(),t){if(!a(t))return void bulmaToast.toast({message:"Invalid minter address.",type:"is-danger"});e+="&minter="+t}!1===document.getElementById("searchOnchainOnly")?.checked&&(e+="&onchain=false"),window.location.search="cmd=tokens"+e}}())),document.getElementById("btnCollectionDataCreate").addEventListener("click",(()=>x())),document.getElementById("btnCollectionDataSave").addEventListener("click",(()=>x())),document.getElementById("cFile").addEventListener("change",(()=>function(){const e=document.getElementById("cFile"),t=document.getElementById("cFileImage"),r=document.getElementById("cFileSizeIcon");if(r.classList.add("is-hidden"),e.files.length>0){let i=e.files[0];document.getElementById("cFileName").innerHTML=i.name;let a="0 Bytes";if(i.size>0){let e=["Bytes","KB","MB","GB","TB"],t=Math.floor(Math.log(i.size)/Math.log(1024));a=parseFloat((i.size/Math.pow(1024,t)).toFixed(2))+" "+e[t],i.size>15360&&(r.classList.add("has-text-danger"),r.classList.remove("is-hidden"),bulmaToast.toast({message:"This file is big. Try to make it smaller.",type:"is-danger"}))}document.getElementById("cFileSize").innerHTML=a;let s=new FileReader;s.readAsDataURL(i),s.onload=e=>{t.classList.remove("is-hidden"),t.setAttribute("src",e.target.result)}}else z()}())),document.getElementById("cFileRemove").addEventListener("click",(()=>z())),document.getElementById("btnTokenDataCreate").addEventListener("click",(()=>J())),document.getElementById("btnTokenDataSave").addEventListener("click",(()=>J())),document.getElementById("nftFile").addEventListener("change",(()=>function(){const e=document.getElementById("nftFile");if($(),e.files.length>0){let t=e.files[0];document.getElementById("nftFileName").innerHTML=t.name;let r="0 Bytes";if(t.size>0){const e=document.getElementById("nftFileSizeIcon");e.classList.remove("has-text-danger");let i=["Bytes","KB","MB","GB","TB"],a=Math.floor(Math.log(t.size)/Math.log(1024));r=parseFloat((t.size/Math.pow(1024,a)).toFixed(2))+" "+i[a],t.size>f&&(e.classList.add("has-text-danger"),e.classList.remove("is-hidden"),document.getElementById("nftCollection").selectedOptions[0].value===c||document.getElementById("nftCollection").selectedOptions[0].text.startsWith("(*)")||bulmaToast.toast({message:"This file is big. Try to make it smaller.",type:"is-danger"}))}document.getElementById("nftFileSize").innerHTML=r;let i=t.type;document.getElementById("nftType").value=i;let a=new FileReader;a.onload=e=>{K(e.target.result,i)},a.readAsDataURL(t)}}())),document.getElementById("btnCreateTokenCreate").addEventListener("click",(()=>Q())),document.getElementById("btnCreateTokenUpdate").addEventListener("click",(()=>Q())),document.getElementById("nftFileRemove").addEventListener("click",(()=>{document.getElementById("nftFile").value="",$()})),document.getElementById("btnTokenList").addEventListener("click",(()=>async function(){B&&document.getElementById("mListTokenAmount").setAttribute("max",B.balance),document.getElementById("mListToken").classList.add("is-active")}())),document.getElementById("btnListTokenList").addEventListener("click",(()=>async function(){if(!B)return void bulmaToast.toast({message:"The token is not found.",type:"is-danger"});let e=Math.round(parseFloat(document.getElementById("mListTokenPrice").value)*10**6);if(Number.isNaN(e)||e<=0)return void bulmaToast.toast({message:"Invalid price.",type:"is-danger"});let t,r=B.token.contract.address,i=B.token.tokenId,a=document.getElementById("mListTokenAmount").value;try{let e=JSON.parse(B.token.metadata.royalties);t=new Map(Object.entries(e.shares));let r=e.decimals;for(let[e,i]of t)t.set(e,Math.trunc(Number(i)/10**r*1e4))}catch(e){t=new Map}let s=document.getElementById("mListTokenStartTiime").value;s=Math.trunc(Date.parse(s)/1e3),s||(s=Math.trunc(Date.now()/1e3));document.getElementById("btnListTokenList").classList.add("is-loading");let o=await async function(e,t,r,i,a,s,o){let m="";if(a&&a.size>0){a=new Map([...a].sort());let e=0;for(let[t,r]of a)e>0&&(m+=","),e++,m+='{"prim":"Elt","args":[{"string":"'+t+'"},{"int":"'+r+'"}]}'}o=o?'"prim":"Some","args":[{"int":"'+o+'"}]':'"prim":"None"';try{let a=await T.requestOperation({operationDetails:[{kind:beacon.TezosOperationType.TRANSACTION,amount:0,destination:t,parameters:{entrypoint:"update_operators",value:JSON.parse('[ { "prim": "Left", "args": [ { "prim": "Pair", "args": [ { "string": "'+h+'" }, { "prim": "Pair", "args": [ { "string": "'+p+'" }, { "int": "'+r+'" } ] } ] } ] } ]')}},{kind:beacon.TezosOperationType.TRANSACTION,amount:0,destination:p,parameters:{entrypoint:"add_offer",value:JSON.parse('{"prim":"Pair","args":[{"prim":"Pair","args":[{"int":"'+i+'"},{"prim":"Pair","args":[{"int":"'+e+'"},['+m+']]}]},{"prim":"Pair","args":[{'+o+'},{"prim":"Pair","args":[{"int":"'+s+'"},{"prim":"Pair","args":[{"string":"'+t+'"},{"int":"'+r+'"}]}]}]}]}')}}]});if(a.transactionHash)return a.transactionHash}catch(e){console.log("ERROR "+n()+"(): "+e+" "+JSON.stringify(e))}}(e,r,i,a,t,s,"");o&&(te(o),document.getElementById("mListToken").classList.remove("is-active")),document.getElementById("btnListTokenList").classList.remove("is-loading")}())),document.getElementById("btnTokenBurn").addEventListener("click",(()=>async function(){B&&document.getElementById("mBurnTokenAmount").setAttribute("max",B.balance),document.getElementById("mBurnToken").classList.add("is-active")}())),document.getElementById("btnBurnTokenBurn").addEventListener("click",(()=>async function(){document.getElementById("btnBurnTokenBurn").classList.add("is-loading");let e=document.getElementById("mBurnTokenAmount").value,t=await async function(e,t,r){try{let i='{"prim":"Pair","args":[{"int":"'+r+'"},{"int":"'+t+'"}]}';try{let r=await fetch("https://api."+l+".tzkt.io/v1/contracts/"+e+"/entrypoints/burn?json=false&michelson=true");(await r.json()).michelsonParameters.startsWith("pair")||(i='{"int":"'+t+'"}')}catch(e){}let a=await T.requestOperation({operationDetails:[{kind:beacon.TezosOperationType.TRANSACTION,amount:0,destination:e,parameters:{entrypoint:"burn",value:JSON.parse(i)}}]});if(a.transactionHash)return a.transactionHash}catch(e){console.log("ERROR "+n()+"(): "+e+" "+JSON.stringify(e))}}(j,q,e);t&&te(t),document.getElementById("btnBurnTokenBurn").classList.remove("is-loading")}())),document.getElementById("btnTokenTransfer").addEventListener("click",(()=>async function(){B&&document.getElementById("mTransferTokenAmount").setAttribute("max",B.balance),document.getElementById("mTransferTokenAddressTo").value="",document.getElementById("mTransferToken").classList.add("is-active")}())),document.getElementById("btnTransferTokenTransfer").addEventListener("click",(()=>async function(){let e=document.getElementById("mTransferTokenAmount").value,t=document.getElementById("mTransferTokenAddressTo").value.trim();if(!a(t))return void bulmaToast.toast({message:"Invalid destination address.",type:"is-danger"});document.getElementById("btnTransferTokenTransfer").classList.add("is-loading");let r=await async function(e,t,r,i){try{let a=await T.requestOperation({operationDetails:[{kind:beacon.TezosOperationType.TRANSACTION,amount:0,destination:e,parameters:{entrypoint:"transfer",value:JSON.parse('[{"prim": "Pair","args":[{"string":"'+h+'"},[{"prim": "Pair","args":[{"string":"'+i+'"},{"prim": "Pair","args":[{"int":"'+t+'"},{"int":"'+r+'"}]}]}]]}]')}}]});if(a.transactionHash)return a.transactionHash}catch(e){console.log("ERROR "+n()+"(): "+e+" "+JSON.stringify(e))}}(j,q,e,t);r&&(te(r),document.getElementById("mTransferToken").classList.remove("is-active")),document.getElementById("btnTransferTokenTransfer").classList.remove("is-loading")}())),document.querySelectorAll(".js-faq-item").forEach((function(e){e.onclick=Z})),document.getElementById("btnConnect").addEventListener("click",(()=>V(!1))),document.getElementById("btnDisconnect").addEventListener("click",(()=>async function(){await async function(){await T.clearActiveAccount(),h=""}(),h||(document.getElementById("divDisconnect").classList.add("is-hidden"),document.getElementById("aAddress").innerHTML="",document.getElementById("divConnect").classList.remove("is-hidden")),window.location.reload()}())),document.getElementById("btnMenuTokens").addEventListener("click",(()=>{window.location.search="cmd=tokens"})),document.getElementById("btnMenuCollections").addEventListener("click",(()=>{window.location.search="cmd=collections"})),document.getElementById("btnMenuListings").addEventListener("click",(()=>{window.location.search="cmd=listings"})),document.getElementById("btnMenuSearch").addEventListener("click",(()=>{window.location.search="cmd=search"})),document.getElementById("btnMenuNewToken").addEventListener("click",(()=>{window.location.search="cmd=tokendata"})),document.getElementById("btnMenuNewCollection").addEventListener("click",(()=>{window.location.search="cmd=collectiondata"})),document.getElementById("btnMenuInfo").addEventListener("click",(()=>{window.location.search="cmd=info"})),document.getElementById("btnMenuCopyAddress").addEventListener("click",(()=>{h&&i(h)&&bulmaToast.toast(U)})),document.getElementById("btnMenuMyTokens").addEventListener("click",(()=>{window.location.search="cmd=tokens&account="+h})),document.getElementById("btnMenuMyCreatedTokens").addEventListener("click",(()=>{window.location.search="cmd=tokens&minter="+h})),document.getElementById("btnMenuMyCollections").addEventListener("click",(()=>{window.location.search="cmd=collections&creator="+h})),document.getElementById("btnMenuMyListings").addEventListener("click",(()=>{window.location.search="cmd=listings&seller="+h})),LT={}})();